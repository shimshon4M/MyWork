<?xml version="1.0" ?>
<root>
  <jtitle>集合分割問題に基づく系列アラインメントのモデル化</jtitle>
  <jauthor>西野正彬鈴木潤梅谷俊治平尾努永田昌明</jauthor>
  <jabstract>2つの系列が与えられたときに，系列の要素間での対応関係を求めることを系列アラインメントとよぶ．系列アラインメントは，自然言語処理分野においても文書対から対訳関係にある文のペアを獲得する対訳文アラインメント等に広く利用される．既存の系列アラインメント法は，アラインメントの単調性を仮定する方法か，もしくは連続性を考慮せずに非単調なアラインメントを求める方法かのいずれかであった．しかし，法令文書等の対訳文書に対する対訳文アラインメントにおいては，単調性を仮定せず，かつ対応付けの連続性を考慮できる手法が望ましい．本論文では，ある大きさの要素のまとまりを単位として系列の順序が大きく変動する場合にアラインメントを求めるための系列アラインメント法を示す．手法のポイントは，系列アラインメントを求める問題を組合せ最適化問題の一種である集合分割問題として定式化して解くことで，要素のまとまりの発見と対応付けとを同時に行えるようにした点にある．さらに，大規模な整数線形計画問題を解く際に用いられる技法である列生成法を用いることで，高速な求解が可能であることも同時に示す．</jabstract>
  <jkeywords>系列アラインメント，組合せ最適化，列生成法</jkeywords>
  <section title="はじめに">系列アラインメントとは，2つの系列が与えられたときに，その構成要素間の対応関係を求めることをいう．系列アラインメントは特にバイオインフォマティクスにおいてDNAやRNAの解析のために広く用いられているが，自然言語処理においてもさまざまな課題が系列アラインメントに帰着することで解かれている．代表的な課題として対訳文アラインメントがあげられる．対訳文アラインメントは対訳関係にある文書対が与えられたときに，文書対の中から対訳関係にある文のペアをすべて見つけるタスクである．統計的機械翻訳においては，対訳コーパスにおいてどの文がどの文と対訳関係にあるかという文対文での対応関係が与えられているという前提のもとで学習処理が実行されるが，実際の対訳コーパスでは文書対文書での対応付けは得られていても文対文の対応付けは不明なものも多い．そのため，対訳文書間での正しい対訳文アラインメントを求めることは精度のよいモデルを推定するための重要な前処理として位置づけられる．統計的機械翻訳以外の，例えば言語横断的な情報検索~などの課題においても対訳文書間の正しい文アラインメントを求めることは重要な前処理として位置づけられる．また，対訳文アラインメントのほかにも，対訳文書に限定されない文書間の対応付けタスクも系列アラインメントとして解かれている~．自然言語処理のタスクにおける系列アラインメント問題を解く手法は，対応付けの単調性を仮定する方法とそうでない方法とに大別される．単調性を仮定する系列アラインメント法は特に対訳文アラインメントにおいて広く用いられる方法であり，対訳関係にある二つの文章における対応する文の出現順序が大きく違わないことを前提として対応付けを行う．すなわち，対訳関係にある文書のペアF，Eに対し，Fのi番目の文f_iにEのj番目の文e_jが対応するとしたら，Fのi+1番目の文に対応するEの文は，（存在するならば）j+1番目以降であるという前提のもとで対応付けを行っていた．この前提は，例えば小説のように文の順序が大きく変動すると内容が損なわれてしまうような文書に対しては妥当なものである．一方で単調性を仮定しない方法は~などで用いられており，文間の対応付けの順序に特に制約を課さずに系列アラインメントを求める．図~は，それぞれ単調性を仮定した系列アラインメント，仮定しない系列アラインメントの例を表している．白丸が系列中のある要素を表現しており，要素の列として系列が表現されている．図では2つの系列の要素間で対応付けがとられていることを線で示している．単調性を仮定した対応付け手法では，対応関係を表す線は交差しない．一方で仮定しない手法では交差することが分かる．系列アラインメントにおいて単調性を仮定することは，可能なアラインメントの種類数を大きく減少させる一方で，動的計画法による効率的な対応付けを可能とする．先述したように，対訳文アラインメントを行う際に単調性を仮定することは多くの対訳文書に対しては妥当な仮定である．しかし，単調性を仮定することが妥当でない対訳文書も存在する．例えば文献~では，単調性が成り立たない文書の例として法令文書を挙げている．そのほかにも例えば百科事典やWikipediaの記事のように一つの文書が独立な複数の文のまとまりからなる場合には，文のまとまりの出現順序が大きく変動しても内容が損なわれないことがある．このような文書においては，文の順序が大きく変動しないという前提は必ずしも正しいものではないため，既存の単調性を仮定した系列アラインメント法では正しい対訳文アラインメントが行えない可能性が高い．一方で，単調性を仮定しない既存のアラインメント法では非単調な対応付けを実現できるものの，対応付けの連続性を考慮することが難しいという問題がある．対応付けの連続性とは，f_iがe_jと対応付けられているならば，f_i+1はe_jの近傍の要素と対応付けられる可能性が高いとする性質のことであるはe_jより後ろにある近傍の要素と対応付けられやすい場合のみを扱っている．しかし，実際には提案法は順方向に連続性がある場合と同様に逆方向の連続性がある場合の対応付けを行うこともできる．逆方向の連続性とは，f_iとe_jが対応付けられているならば，f_i+1はe_j以前の近傍の要素と対応付けられる可能性が高いとする性質のことである．．もし対応付けにおいて連続性を考慮しないとすると，系列F中のある要素f_iとそれに隣接する要素f_i+1とが，それぞれE中で離れた要素と対応付けられてもよいとすることに相当する．対応付けの単調性を仮定できるような対訳文書の対訳文アラインメントについては，明らかに対応付けの連続性を考慮する必要がある．さらに，単調性が仮定できないような文書のペアに対する対訳文アラインメントにおいても，ある文とその近傍の文が常に無関係であるとは考えにくい．以上より，文アラインメントにおいては連続性を考慮することが不可欠である．また，対訳文アラインメント以外の系列アラインメントを用いるタスクにおいても，対応付けの対象となる系列は時系列に並んだ文書等，何らかの前後のつながりを仮定できるものが多いことから，連続性を考慮する必要がある．単調性を仮定できない文アラインメントの例を示す．図は，文献~の検証で用いられているBilingualLawsInformationSystem(BLIS)コーパスに含まれる対訳文書における文アラインメントの例である．BLISは香港の法令文書の電子データベースであり，対訳関係にある英語・中国語の文書を保持している．図に示す対訳文は用語の定義を行っている箇所である．両言語の文を比べると，定義する用語の順番が英語と中国語とで異なっており，結果として，局所的には連続なアラインメントが非単調に出現する対訳文書となっている．本論文では系列の連続性を考慮しつつ，かつ非単調な系列アラインメントを求めるための手法を提案する．このような系列アラインメント法は，単調性を仮定できない文書対の対訳文アラインメントを求める際に特に有効であると考える．仮に文書Fの文がEの任意の文と対応してもよいとすれば，ある文のペアの良さを評価するスコアを適切に設定することによって，問題を二部グラフにおける最大重みマッチング問題として定式化して解くことができる．しかし，Fのある文がEの任意の文と対応してもよいという前提では，近傍の文間のつながりを無視して対応付けを行うことになる．実際の文書ではすべての文がその近傍の文と無関係であるとは考えにくいため，正しい対応付けが行えない可能性が高い．そこで，提案手法では対訳文アラインメントを組合せ最適化の問題の一つである集合分割問題として定式化して解く．集合分割問題は，ある集合Sとその部分集合族S_1,,S_Nが与えられたときに，スコアの和が最大となるようなSの分割DS_1,,S_Nを見つける問題である．ここでDがSの分割であるとは，S=_S_iDS_iかつijならば任意のS_i,S_jDについてS_iS_j=となることをいう．2つの系列F,Eのある部分列に対する単調な系列アラインメントの集合をS_1,,S_Nとして表現することで，部分列に対するアラインメントの集合S_1,,S_Nから系列全体の分割となるような部分集合を選択する問題としてF,E全体に対する系列アラインメントを求めることができる．また，本論文では集合分割問題としての系列アラインメントの定式化とともに，その高速な求解法も同時に示す．提案する集合分割問題に基づく定式化を用いると，系列F,Eに含まれる要素の数が増加するに伴い，急激に厳密解の求解に時間がかかるようになるという課題がある．これは，それぞれの系列に含まれる要素の総数を|F|,|E|とすると，集合分割問題に出現する変数の数がO(|F|^2|E|^2)となるためである．集合分割問題はNP困難であり，変数の数が増加すると各変数に対応する重みの計算および整数線形計画法ソルバを用いた求解に時間がかかるようになる．本論文ではこの課題に対処するために，多くの変数が問題中に出現する大規模な線形計画問題を解く際に用いられる，列生成法を用いることで高速な系列アラインメントを実現する近似解法も同時に提案する．列生成法は大規模な問題の解を，出現する変数の個数を制限した小さな問題を繰り返し解くことによって求める手法である．列生成法を用いることによって，そのままでは変数の数が膨大となり解くことができなかった問題を解くことができる．なお，列生成法を用いることで線形計画問題の最適解を得られることは保証されているが，整数線形計画問題については解を得られることは必ずしも保証されていない．そこで本論文では列生成法で得られた近似解を実験によって最適解と比較し，よい近似解が得られていることを確認する．なお，以下では説明を簡単にするために特に対訳文書の対訳文アラインメントに話題を限定して説明を進める．ただし，系列の要素間のスコアさえ定まれば提案法を用いて任意の系列のペアに対する系列アラインメントを行うことが可能である．</section>
  <section title="関連研究">対訳文アラインメントに関しては，これまで，文の長さを対応付けに利用する方法，語の翻訳確率と文の長さを利用する方法などが提案されてきているが，ほとんどの方法でアラインメントの単調性を仮定している．単調性を仮定することによって動的計画法によって効率的に対訳文アラインメントを求めることができるという利点はあるが，序章で述べたように単調性が成り立たない文書対に対しては正しいアラインメントを求めることができないという欠点がある．Dengらは系列マッチングとクラスタリングをあわせて利用することで，文の順序が入れ替わる場合でも対訳文アラインメントを行える手法を提案している．しかし，Dengらの手法は，ある隣接する二つの文の順序が入れ替わるなど，順序の入れ替わりが小さい範囲で起きることを想定した手法であり，より大きな範囲での順序の入れ替わりには対処できない．対訳文間の単調性を仮定しない，非単調な対訳文アラインメントを求めるための手法として，近年Quanらは半教師あり学習の枠組みに基づく文対応付け手法を提案している．彼らの手法は基本的には二部グラフマッチングに基づくアラインメント法であるが，各文書における文間の類似度合いを対応付けのための目的関数に用いている点が特徴的である．Quanらの手法と比較すると，提案法は文のまとまり単位のアラインメントをより明示的に意識した手法となっていることが異なる．Quanらの手法は隣り合う文間の関係を明示的には考慮しないため，対訳文書間で文の出現順序が全く異なる文書により適している．また，Quanらの手法は二部グラフマッチングに基づく手法のため多対多のアラインメントには対応できないが，提案法は内部で呼び出す既存の単調性を仮定した対訳文アラインメント法を多対多のマッチングを考慮するものに変更することによって，容易に多対多の対訳文アラインメントを行うように拡張できる点も異なる．対訳文アラインメント以外にも，さまざまな自然言語処理のタスクが系列アラインメント問題として定式化され解かれている．例えば質問応答ウェブサイトにおける質問と回答との対応付け~や，ウェブサイトにおけるレビュー文とそれに対する返答のペア~，条例文~の対応付けといったタスクなどがある．対訳文アラインメント以外の自然言語処理における重要な系列アラインメント問題の適用先として，単語アラインメントが挙げられる．単語アラインメント問題に関しては非単調なアラインメントを求めるための手法が数多く提案されてきている．Brownらは，原言語の各単語は必ず目的言語のある単語に対応付けられるなどの制約のもとで，生成モデルに基づいた単語の非単調なアラインメントを行っている．また，Wuは反転トランスダクション文法に基づいた非単調な単語アラインメント法を提案している．これらのうち，は単語アラインメントに固有の性質を扱っており，本論文で扱っている対訳文アラインメントに直接適用するのは難しい．また，反転トランスダクション文法に基づく手法は，提案法に類似の非単調な対訳文アラインメントを実現可能な文法規則を設計できる．しかし，反転トランスダクション文法では連続な文間の非単調なアラインメントの形態が制限される点が提案手法と異なる．</section>
  <section title="単調性を仮定した対訳文アラインメント法">提案法の説明の準備として，単調性を仮定した動的計画法に基づく既存の対訳文アラインメント法について説明する．単調性を仮定した対訳文アラインメント法では，対訳文書F,Eのある文のペアsF,tEが対応付けられた時のスコアS(s,t)が与えられたときに，スコアの総和が最大となるような単調な対訳文アラインメントを求める．アラインメントの単調性を仮定すると，最適な系列アラインメントは動的計画法を用いることで高速に求めることができる．これまでにさまざまなスコアS(s,t)の定義が提案されてきているが，代表的な対訳文アラインメント法であるMooreによる手法では，文の長さと文中の語の翻訳確率とを用いることでペアのスコアを定義し，対訳文アラインメントに含まれるペアのスコアが最大となるようにアラインメントを求める．具体的には，sFである文sとtEである文tとのペアのスコアS(s,t)をとして定める．ここで，m_s,m_tはそれぞれ文s,tに含まれる単語の総数である．また，s_i,t_jはそれぞれsのi番目の語，tのj番目の語を表す．tr(t_j|s_i)は語s_iがt_jに翻訳される確率である．u(s_i)は語s_iの文書中での相対頻度を表す．P(m_s,m_t)は，文の長さ（語の数）に応じてスコアを定める関数であり，ポアソン分布を用いてとして定義される．rはパラメータである．各確率分布は~にある手法によってデータから推定できる．</section>
  <section title="集合分割問題に基づく対訳文アラインメントのモデル化">本論文で提案する対訳文アラインメント法の概観を示す．提案法のポイントは，文書を連続する文のまとまりに分割してアラインメントを求める点にある．すなわち，対訳文書のそれぞれを同数の文のまとまりに分割したのち，どの文のまとまり同士が対応付けられるか対応付けられた文のまとまりのペアの中で，どの文のペアが対応付けられるかを同時に求めることで対応付けを行う．このときに(1)について非単調な対応付け，(2)については単調な対応付けを行うことによって，連続性を考慮した非単調な対応付けを実現する．それぞれの文書を3つのまとまりに分割したときの提案法による対訳文アラインメントの様子を図に示す．図中の白い丸がひとつの文に対応している．また，複数の丸を囲む四角が文のまとまりを表す．図より，文のまとまり同士の対応付けにおいては非単調な対応付けを行っていることと，文のまとまりに含まれている文同士の対応付けにおいては単調な対応付けを行っていることが分かる．文のまとまりに含まれる文同士の対応付けは，既存の単調な対訳文アラインメント法によって行われる．つまり，対応付けられる各文書を1つのまとまりだとみなした場合は，文書全体で単調な対応付けを行うことになるため，提案手法は既存の対訳文アラインメント法と同等である．以下で用いる記法について述べる．対応付けをとる対象の2つの文書をF,Eとし，それぞれ|F|，|E|個の文からなるとする．f_iをFに含まれるi番目の文，e_kをEに含まれるk番目の文とする．Fのi番目からj番目までの連続する文の集合をf_ijFとする．ただし1ij|F|である．同様に，e_klEはEのk番目からl番目までの連続する文の集合とする．ただし1kl|E|である．また，a_ijklを文のまとまりのペア(f_ij,e_kl)を表現するために用い，f(a_ijkl)=f_ij,e(a_ijkl)=e_klと定義する．文のまとまりf_ijとe_klのペアに対して，既存の単調性を仮定した対訳文アラインメント法を適用することによって得られる文アラインメントのスコアをseqMatch(f_ij,e_kl)とする．すなわち，f_ij，e_kl間のある単調なアラインメントをX,すべての単調な対訳文アラインメントの集合をA_ijklとすると，seqMatch(f_ij,e_kl)はとして定義される．</section>
  <subsection title="集合分割問題に基づく定式化">前節で定義したseqMatch(f_ij,e_kl)は，文のまとまりf_ijとe_klのペアに対する対応付けスコアであるとみなすことができる．このスコアを用いて文のまとまり同士の一対一の対応付けを求める．文のまとまり同士の対応付けを求めることができれば，それに含まれる文間の対応付けはseqMatch(f_ij,e_kl)を求める際に既に求めてあるため，結果として対訳文アラインメントが得られる．可能なすべての文のまとまりのペアa_ijklの集合をMとすると，ある文アラインメントは，Mの部分集合であり，かつ文書対の分割となっているような文のまとまりのペアの集合AMとして表現できる．ただし，Aに含まれる任意の文のまとまりのペアa,a^Aについてf(a)f(a^)=かつe(a)e(a^)=であり，_aAf(a)=Fかつ_aAe(a)=Eを満たすものとする．上記の条件を満たすAの集合をAとすると，対訳文アラインメントを求める問題は，として，マッチングのスコアを最大とするAを求める問題として定式化することができる．ここでscore(A)は，FとEに対する分割Aを定めたときのスコアであり，以下のように定義する．ここでKはA中に含まれる文のまとまりのペアの総数，はペアの個数に応じて課されるペナルティを表すパラメタであり，0&lt;1を満たすように設定する．=1とすると解に出現する文のまとまりのペアの個数に制限をつけないことに相当するため，文の連続性を考慮しないアラインメントが得られる．一方でに小さな値を設定することは，解に出現する文のまとまりの個数に対して大きなペナルティを与えることに相当するため，できるだけ小ない個数の文のまとまりが解に含まれるようになる．をある程度以上小さな値に設定すると常に1つの文のまとまりのペアに分割されるようになる．これは既存の単調な対訳文アラインメントと等しい．式()の対数をとると，score(A)は文のまとまりのペアaに対する線形式に置き換えることができる．よって，ここでの対訳文アラインメント問題は整数線形計画問題(ILP)として定式化することができる．ILPによる定式化は，&amp;_ijkl(w_ijkl+)y_ijkl&amp;_i,j:ixj_kly_ijkl=1~~~~~x:1x|F|&amp;_ij_k,l:kxly_ijkl=1~~~~~x:1x|E|&amp;y_ijkl0,1~~~~~~~~~~~~i,j,k,lalignとなる．ここで，w_ijklはseqMatch(f_ij,e_kl)の値である．y_ijklは文のまとまりのペアa_ijklをアラインメントに含むことを表す変数であり，y_ijkl=1のときはa_ijklが対訳文アラインメントに含まれるとする．制約()は，F中のx番目の文を含むすべての文のまとまりのペアa_ijklのうち，必ず1つだけが解に選択されることを保証するものである．()は同様の制約をEに課したものであり，これら2つの制約を併せてFとEに含まれる各文が最終的に得られた文のまとまり同士の対応付けのいずれか1つに必ず含まれることを保証する．今回用いた定式化は，任意のペア(f_ij,e_kl)に対応する集合の集まりである集合族に対する集合分割問題となっている．なお，提案法は既存の単調な文アラインメント法として，多対多のアラインメントを求めることができる手法を用いることによって，非単調な多対多のアラインメントを実現することができる,e_kl)を通常順，逆順の全ての可能な対応付けからスコアを最大にするものを選択するように修正すればよい．逆順の単調なアラインメントは，片方の系列を逆順にしたうえで，単調性を仮定した動的計画法によるアラインメント法を実行することで求めることができる．．</subsection>
  <section title="列生成法">式~()から~()からなる整数線形計画問題はすべての文のまとまりのペア数に対応する数の変数を含む．このようなペアは|F||E|(|F|+1)(|E|+1)/4種類存在するため，文の数が増加すると整数線形計画問題に含まれる変数の数が急増し，解を求めるのに時間がかかるという問題がある．本論文では列生成法~を用いた近似解法を導入することでこの問題に対応する．一般的な整数線形計画問題の解法では，すべての変数を求解時に明示的に扱って解を求めるが，列生成法では目的関数の増加に寄与する可能性がある変数を逐次的に追加しながら問題を解くことで解を求める．最適解において非ゼロとなる変数の数が問題全体で扱う変数の数に対して非常に小さい場合，最適解においてゼロとなる変数を考慮せずに解が得られる可能性が高いことから，列生成法によって高速に解を得られることが期待できる．以下，列生成法に基づく解法の詳細を述べる．列生成法を導入するにあたり，いくつかの概念を定義する．まず，式~()から~()からなる整数線形計画問題を線形緩和した問題，つまり制約a_ijkl0,1を0_ijkl1へと緩和した問題を主問題(Masterproblem:MP)とよぶ．主問題に含まれるすべての変数の集合をMとする．MPからいくつかの変数を取り除いた問題を制限された主問題(Restrictedmasterproblem:RMP)とよぶ．RMPに出現する変数の集合をM^Mと表す．ある線形計画問題の双対問題とは，もとの問題の各変数にそれぞれ対応する制約条件と，もとの問題の各制約条件に対応する変数からなる線形計画問題のことである．RMPに対しても双対問題を考えることができる．双対問題においてRMPにおける文f_nに関する制約に対応する変数をu_n,e_mに関する制約に対応する変数をv_mとする．線形計画問題が最適解を持つのであれば，最適解の値はそれは双対問題の最適解の値と一致することが知られており，RMPの最適解を単体法を用いて得ることができたならば，双対問題の最適解も容易に計算可能である．列生成法はRMPの求解とRMPに追加する変数を求める問題とを繰り返し解くことでMPを解く．追加する変数を求める問題は列生成部分問題とよばれ，具体的にはa_ijklMM^であるようなa_ijklのうち，を最大とするものを一つ求める問題である．ここで，u_nはRMPの双対問題の最適解における変数u_nの値，v_mは変数v_mの値とする．以下ではw_ijklのことを被約費用とよぶ．あるRMPを解いた後に各変数に対する被約費用がすべて負となるとき，RMPの最適解はMPの最適解となることが知られている．最適解において多くの変数の値がゼロとなるような問題においては，出現する変数の数がMPよりも大幅に少ないRMPを解くことでMPの最適解が得られることが期待できるため，列生成法は大規模な最適化問題を高速に解くことができる．列生成部分問題を解くことを考える．前述のとおり，変数は|F||E|(|F|+1)(|E|+1)/4個あるため，その全てについて被約費用を求めるのは困難である．しかし，スコアw_ijklが章で述べたように動的計画法によって求められること，および被約費用の式~()においてu_n,v_mが対応する文ごとにそれぞれ独立に作用していることを利用すると，最大の被約費用をSmith-Waterman法~に類似した動的計画法によって求めることができる．Smith-Waterman法はバイオインフォマティクスの分野で提案された，配列の局所アラインメントを求めるためのアルゴリズムであり，動的計画法に基づいて長さN,Mの二本の配列に対する局所アラインメントをO(NM)時間で求めることができる．ここで局所アラインメントとは，二本の配列の可能な部分配列間の系列アラインメントのうち，スコアを最大とするもののことである．動的計画法は以下の局所アラインメントの再帰的な定義に沿って計算する．なお，以下では説明を簡単にするため，提案法内で利用する単調なアラインメントを求める手法が一対一のアラインメントのみを求めると仮定している．しかし，多対多のアラインメントを求めることができる手法を利用した場合であっても，下記の再帰式を容易に拡張することが可能である．q[j,l]をその末尾の要素がそれぞれf_j,e_lであるような文のまとまりのペアの被約費用w_ijkl(1ij,1kl)の最大値とすると，q[j,l]はとして再帰的に計算することができる．なおq[0,0]=とする．ここでS(f_j,e_l),S(f_j),S(e_l)は，既存の単調性を仮定した（例えばなど）対訳文アラインメント法において利用されるスコアであり，それぞれ文f_jと文e_lとを対応付けたときのスコア，f_jをEのどの文とも対応させなかったときのスコア，e_lをFのどの文とも対応させなかったときのスコアである．最上段の選択肢は，f_j+1,e_l+1を開始位置とする文のまとまりのペアの被約費用が，f_j,e_lを含む文のまとまりのペアの被約費用よりも必ず大きくなるときに選択される．すべての1j|F|,1l|E|について動的計画法によってq[j,l]を計算したのちに，それらのうち最大値をとることで被約費用の最大値を求めることができる．さらに，q[j,l]を計算する際に()のどの式をもとに計算したかを記憶しておけば，最大値をとるq[j,l]からバックトラッキングを実行することによって被約費用を最大とするx_ijklを求めることができる．すなわち，()の4種類の選択肢のうち，下3種類の選択肢のいずれかが利用されたのであればそれぞれの式中に出現しているq[j-1,l-1],q[j-1,l],q[j,l-1]のいずれかに遷移し，バックトラッキングを続ける．もし最上段の選択肢が利用されたのであれば，そこでバックトラッキングを終了する．バックトラッキングを終了したときの状態をq[j^,l^]とすると，i=j^+1，k=l^+1，としてiとkが求まる．すべてのq[j,l]を計算する動的計画法はO(|F||E|)，バックトラッキングは高々O(|F|+|E|)時間で実行できるため，Smith-Waterman法によって被約費用を最大とするアイテムを効率的に選択できる．列生成法の手順を図~に示す．まずRMPに含まれる変数の集合をM^=x_1|F|,1|E|として初期化する(line1)．x_1|F|,1|E|はすべての文からなる文のまとまりであり，実行可能解であることから，以降のRMPは必ず実行可能解をもつことが保証される．以降，RMPの求解(line3)とSmith-Waterman法による列生成部分問題の求解(line4)とを繰り返す．もしすべての変数で被約費用が負となったら(line5)，その時点でMPの最適解が得られていることになるので，最後に現在のRMPに整数制約を追加したうえで整数線形計画問題を解いて得られた解を出力する(line8)．ここで，RMPに整数制約を追加して得られた解が必ずしも元のMPに整数制約を追加して得られた解と一致するわけではないことに注意する必要がある．すなわち，提案法はヒューリスティクスであり，必ずしも厳密な最適解を得られるわけではない．そこで検証によって厳密解との差を評価する．</section>
  <section title="検証"/>
  <subsection title="検証設定">提案手法の有効性を検証する．非単調な系列アラインメントはいくつかの研究で検証されているが，正解の対応付けが公開されていないことから，今回は検証のためのデータとして文対応が既知である日本語と英語の対訳文書から生成した人工データを用いた．対訳文書はそれぞれ約25,000文からなる．この文書から取り出した2,500文から文の長さが一定以上に長いものと短いものとを除いたものをテストデータを生成する元データ，残りを翻訳確率等を推定するための訓練データとして用いた．テストデータの生成手順は以下のとおりとする．まず，元データのそれぞれの文書集合から，K個の対応関係にある連続する文のまとまりをランダムに取り出す．なお，対応関係にある文のまとまりには，対訳関係になっていない文も含まれる．その後，取り出した文のまとまりをランダムに並べなおしたのちに，各まとまりに含まれる文を順に並べることで文のまとまり単位での移動があるデータセットを作成した．テストデータの文の数は日本語，英語ともに60文とし，まとまりの数はK=1,3,6,12,20とした．このデータセットを以下では対称データセットとよぶ．K=1のときは単調な対訳文アラインメントを求める問題となっている．次に，日本語と英語の文の数が異なるデータセットも同様に作成した．こちらでは日本語の文数を60文，英語の文数を40文とし，日本語の20文は対応する文が存在しないようにした．日本語のまとまりの数はK=3,6,12とし，英語のまとまりの数は日本語のまとまりの数の2/3とした．このデータセットを以下では非対称データセットとよぶ．最後に，日本語と英語からそれぞれ60文選ぶが，そのうち対応関係にあるのは40文であり，残りの日本語・英語の20文は対応する文が存在しないようなデータも作成した．以下では対応なしデータセットとよぶ．文のまとまりの数はK=3,6,12とし，そのうち1/3については対応する文が存在しないものとした．比較対象として，Mooreらによる系列マッチングに基づく手法(Moore)と，二部グラフの重み最大マッチングとして解いた方法(BM)とを用いた．なお，重み最大マッチングにおける対応付けの重みは式()を用いた．評価はMooreにならって，文の対応付けの再現率(recall)，適合率(precision)，F値(F-measure)を算出した．対称，非対称の各データセットについて，異なるKごとに5つのデータセットを生成し，その平均値を最終的な評価値とした．翻訳確率の算出にはGIZA++を用いた．整数線形計画問題のソルバとしてILOGCPLEXを用いた．文のまとまりの個数に対するペナルティは，=0.1と=0.01の2種類を試した．</subsection>
  <subsection title="結果">実験結果を表,，に示す．表中のSP+ILPは集合分割問題を整数線形計画問題ソルバで解いた結果，SP+CGは集合分割問題を列生成法で解いた結果を表す．また，BMは二部グラフマッチングによって対訳文アラインメントを行った結果，MooreはMooreらの手法~を適用した結果をそれぞれ表す．表より，対称データセットでK=1の場合を除く，いずれのデータセット，およびKの値においても，=0.1としたときの提案手法（厳密解）が2種類のベースラインよりも高いF値を示していることが分かる．対称データセットでK=1の場合は単調な対訳文アラインメントとなることから，単調性を仮定するMooreの手法の方がやや高いF値を示している．しかし，提案法との差分は0.003ポイントと小さい．次にの値の違いによる影響を厳密解同士で比較すると，いずれのデータセットにおいてもK=1,3のときは=0.01の方が=0.1のときよりもやや高いF値を示し，一方でK=6,12,20のときには=0.1の方が高い値を示していることが分かる．これは，が文のまとまりの個数に対するペナルティであり，が小さいほど大きなペナルティを与えていることによって説明できる．つまり，Kが小さいときは文のまとまりの個数が小さくなりがちな=0.01の方がよい結果を出力し，Kが大きいときはより多くのまとまりが出現することを許容する=0.1の方がよい結果を出力していると考えられる．Mooreによる対応付け手法は単調性を仮定した手法であるため，他の方法と比べると極端にF値が悪くなっているのが確認できる．次に提案手法で厳密解を求めたときと，列生成法による近似解を求めたときとの結果を比較する．再現率，適合率，F値の低下度合いは，今回の検証では最大で0.08ポイント程度の低下におさまっていることが確認できた．特に=0.1のときはいずれのデータに対しても0.03ポイント程度の低下におさまっている．なお，表では列生成法のほうが厳密解法よりも再現率，適合率，F値が大きくなる結果が得られているが，これは目的関数と評価指標とが必ずしも一致するわけではないことに起因すると考えられる．厳密解法と列生成法との平均計算時間の比較を表~に示す．表より，CPLEXで数十秒から数百秒かかっていた問題が列生成法によって数秒で解けていることが確認できる．すべてのデータで30倍から400倍程度の高速化が達成できたが，特に変数の総数が多い対称データ，対応なしデータではほぼすべての設定で100倍以上の高速化が確認できた．表~に利用された変数の数を示す．集合分割問題をそのまま整数線形計画問題ソルバによって解くと，今回扱ったような数十文程度の対応付けであっても10^6個程度の変数を明示的に扱う必要がある．扱う変数の個数が多いほどソルバによる求解には時間がかかるため，文の数が増加するとさらに求解に時間がかかる可能性が高い．一方で列生成法を用いた場合は，最適解において非零になる可能性がある変数しか扱わないため，最終的に利用された変数は10^3個程度となり，問題をソルバで素朴に解いた場合と比較して利用される変数の数が大幅に少ないことが分かる．問題中に出現する変数の個数が少ないとソルバによって高速に解を求めることが可能であるため，列生成法は高速に動作したと考えられる．提案法はNP困難問題である集合分割問題を解いているため，厳密解法の実行時間は問題サイズに対して指数的に増加する．一方で，既存の単調性を仮定した動的計画法に基づく対訳文アラインメント法は，問題サイズに対して多項式時間で動作する．そのため，提案法は列生成法による近似解法を用いたとしても実行時間的には既存手法に対する優位性はない．一方で，対訳文アラインメントはおもに対訳文コーパスを作成するために用いられる技術であり，コーパス生成に用いるために問題とならない速度で動作することが重要である．実験結果が示すように，列生成法による対訳文アラインメント法は数十文からなる対訳文書の文アラインメントを数秒で行うことができるため，提案法は十分に実用に足る技術であるといえる．最後に，対称データにおいて入力文のサイズを変化させたときの，厳密解法と列生成法の実行時間の変化を図~に示す．図の横軸が入力のサイズであり，縦軸が実行時間を表す．なお，実行時間が3,600秒を超えたら実験を打ち切りとしている．入力サイズが大きくなるほど，列生成法と厳密解法の差が広がる傾向があることが分かる．</subsection>
  <section title="おわりに">本論文では，対応付けの連続性を考慮しつつ非単調な系列アラインメントを求めるための方法を提案した．集合分割問題として定式化し，整数線形計画法を用いて解くことによって，既存手法では対応付けをとるのが難しい状況でも対応付けができることを示した．このような方法は，特に単調性を仮定できないような文書対に対する対訳文アラインメントにおいて効果的である．さらに，数理計画法の分野で大規模な問題を解く際に利用される技法である列生成法を適用することによって，最適化問題を解くときに扱わなければならない変数の数および各変数のスコアの計算に必要となる動的計画法の実行回数を劇的に減らすことができ，結果として高速な求解を可能とした．document</section>
</root>
