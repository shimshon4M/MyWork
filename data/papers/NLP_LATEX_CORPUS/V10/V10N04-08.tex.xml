<?xml version="1.0" ?>
<root>
  <title>大規模テキスト知識ベースに基づく自動質問応答---ダイアログナビ---</title>
  <author>清田陽司黒橋禎夫	木戸冬子</author>
  <jabstract>本論文では，大規模テキスト知識ベースに基づく対話的自動質問応答システム「ダイアログナビ」について述べる．本システムは，2002年4月からWWW上で一般公開し，パーソナルコンピュータの利用者を対象としてサービスを行っている．実世界で用いられる質問応答システムにおいては，ユーザ質問の不明確さや曖昧性が大きな問題となる．本システムは，「エラーが発生した」のような漠然とした質問について，対話的に聞き返しを行うことによってユーザが求める答えにナビゲートする．聞き返しの方法としては，頻繁になされる漠然とした質問に対する聞き返しの手順を記述した対話カードを用いる手法と，自動的に聞き返しの選択肢を編集して提示する手法を組み合わせて用いている．また，適切なテキストを正確に検索するために，ユーザ質問のタイプ，同義表現辞書や，日本語の文の係り受け関係などを利用している．</jabstract>
  <jkeywords>対話システム，情報検索，質問応答，テキスト知識ベース</jkeywords>
  <section title="はじめに">empty何かを調べたいとき，一番よい方法はよく知っている人(その分野の専門家)に直接聞くことである．多くの場合，自分の調べたいこととその答えの間には，具体性のズレ，表現のズレ，背景の認識の不足などがあるが，専門家は質問者との対話を通してそのようなギャップをうめてくれるのである．現在，WWWなどに大規模な電子化テキスト集合が存在するようになり，潜在的にはどのような質問に対してもどこかに答えがあるという状況が生まれつつある．しかし，今のところWWWを調べても専門家に聞くような便利さはない．その最大の原因は，上記のようなギャップを埋めてくれる対話的な能力が計算機にないためである．例えば，ユーザがWWWのサーチエンジンに漠然とした検索語を入力すると多くのテキストがヒットしてしまい，ユーザは多大な労力を費して適切なテキストを探さなければならない．このような問題は，ドメインを限定し，ユーザが比較的明確な目的を持って検索を行う場合でも同様である．我々は予備調査として，マイクロソフトが提供している自然言語テキスト検索システム「話し言葉検索」の検索ログを分析した．その結果，全体の約3割の質問はその意図が不明確であることがわかった．このような曖昧な質問に対しては多くのテキストがマッチしてしまうので，ユーザが検索結果に満足しているとはいいがたい．この問題を解決するためには，「曖昧な質問への聞き返し」を行うことが必要となる．すでに実現されている情報検索システムには，大きく分けてテキスト検索システムと質問応答システムの2つのタイプがある．前者は質問キーワードに対して適合するテキスト(のリスト)を返し，後者は質問文に対してその答えを直接返す．しかし，曖昧な質問を行ったユーザを具体的なテキストまたは答えに導く必要性は両者に共通する．以下では，「曖昧な質問への聞き返し」に焦点をあてて，過去の研究を俯瞰する(表)．テキスト検索システムにおいて，質問とテキストの具体性のギャップを埋めるために聞き返しを行う方法としては，以下の手法が提案されてきた．テキストによる聞き返し検索結果から適合テキストをユーザに判定させ，それを検索式の修正に反映させる手法は，SMARTシステムなどで実験が行われている．GoogleなどのWWWサーチエンジンでは，検索結果からテキストを1個選んで，その関連テキストを表示させることができるが，この方法もユーザによる適合テキストの判定とみなすことができる．関連キーワードによる聞き返し検索結果から，ユーザが入力したキーワードに関連するキーワードを抽出し，選択肢として提示するシステムとしては，RCAAU，DualNAVI，Exciteなどがある．テキストと関連キーワードを組み合わせた聞き返しTHOMASは，ユーザの情報要求を，「イメージ」とよばれるキーワード集合として保持し，テキスト1個と関連キーワードを併せて提示してそれらの適合性をユーザに判定させるプロセスを繰り返すことで，「イメージ」を徐々に具体化させようとするシステムである．ただし，1970年代に提案されたシステムであり，小規模なテキスト集合にしか適用できない．クラスタリング検索されたテキストをクラスタリングし，クラスタを選択肢として提示するシステムとしては，Scatter/Gather，WEBSOMなどがある．これらのシステムでは，各クラスタは，それに属するテキストのリストや，代表的なキーワードのリストとして表現されている．これらのシステムの聞き返しの媒体は，いずれもキーワードまたはテキストのレベルである．しかし，キーワードは抽象化されすぎており表現力がとぼしく，逆にテキストは具体的すぎるため，聞き返しの媒体としては必ずしも適切ではない．一方，質問応答システムとしては，1980年代にUCなどのシステムが研究された．これらのシステムは，ユーザの意図が曖昧な場合に自然言語による聞き返しを行う能力を備えていたが，そのためには人工言語で記述された，システムに特化した知識ベースが必要であった．しかし，十分な能力をもつ人工言語の設計の困難さ，知識ベース作成のコストなどの問題から，このような方法には明らかにスケーラビリティがない．1990年代になって，電子化された大量の自然言語テキストが利用可能になったことから，自然言語テキストを知識ベースとして用いる質問応答システムの研究が盛んになってきた．インターネットのニュースグループのFAQファイルを利用するシステムとしては，FAQFinderがある．また最近は，構造化されていないドメイン独立のテキスト(新聞記事やWWWテキスト)を用いた質問応答システムの研究が，TRECQATrackやNTCIRQACにおいて盛んに行われている．しかし，これらのシステムはユーザの質問が具体的であることを前提にして，1回の質問に対して答えを1回返すだけであり，曖昧な質問に対して聞き返しを行う能力は備えていない．京都大学総合情報メディアセンターのヘルプシステムは，自然言語で記述された知識ベースとユーザ質問の柔軟なマッチングに基づいて，曖昧な質問に対して自然言語による聞き返しを行うことができるシステムである．しかしそこでは，記述の粒度をそろえ，表現に若干の制限を加えた知識ベースをシステム用に構築しており，「曖昧な質問への聞き返し」のプロトタイプシステムという位置づけが適当である．これに対して，本論文では，既存の大規模なテキスト知識ベースをもとにして，自然言語による「曖昧な質問への聞き返し」を行い，ユーザを適切なテキストに導くための方法を提案する．具体的には，パーソナルコンピュータのWindows環境の利用者を対象とした自動質問応答システム「ダイアログナビ」を構築した(図)．本システムの主な特徴は以下の通りである．大規模テキスト知識ベースの利用マイクロソフトがすでに保有している膨大なテキスト知識ベースをそのままの形で利用する．正確なテキスト検索ユーザの質問に適合するテキストを正確に検索する．そのために，質問タイプの同定，同義表現辞書による表現のずれの吸収，係り受け関係への重みづけなどを行っている．ユーザのナビゲートユーザが曖昧な質問をしたとき，対話的に聞き返しを行うことによってユーザを具体的な答えにナビゲートする．聞き返しの方法としては，対話カードと状況説明文の抽出の2つの方法を組み合わせて用いる．どちらの方法が用いられても，システムは具体的なフレーズを聞き返しの選択肢として提示する．*5mm図の例では，「エラーが発生する」という漠然とした質問に対して2回の聞き返しを行ってユーザの質問を対話的に明確化させた後，知識ベースを検索してその結果を提示している．その際，ユーザの質問をより具体化させるような部分を検索されたテキストから抽出して提示している．本論文では，このような対話的質問応答を可能とするためのシステムを提案する．まず節において，システムの構成を示す．つづいて，節では正確なテキストの検索を行うための手法を，節ではユーザのナビゲートを実現するための手法を，具体的に提案する．さらに節において，提案手法を実装したシステム「ダイアログナビ」を公開運用して得られた対話データベースの分析結果を，提案手法の評価として示す．最後に節で本論文のまとめを述べる．</section>
  <section title="ダイアログナビの構成">ダイアログナビにおいて使用するリソースを以下に示す．知識ベースマイクロソフトがすでに一般に公開しているテキスト知識ベースをそのまま用いる．その種類と規模を表に示す．また，知識ベースのうちサポート技術情報に含まれるテキストの例を図に示す．同義表現辞書(項，図)ユーザ質問文と知識ベースの間の表現のずれを吸収するために，同義語や同義フレーズをグループ化した辞書を用いる．現在，ダイアログナビの同義表現辞書には，919グループの同義表現が存在し，3512語・217フレーズが登録されている．上位・下位語辞書(項，図)上位・下位の関係にある語(「ブラウザ」と「InternetExplorer」など)を関係づけた辞書を用いる．現在，200語が登録されている．対話カード(節，図)曖昧なユーザ質問文のうち典型的なものに対して，どのような聞き返しを行うかを記述したカードを利用する．ダイアログナビの内部の処理と，ユーザとの対話の関係を図に示す．基本的な流れは，対話カードに基づくユーザとの対話によってユーザの質問が具体化され(図の左側のループ)，具体化された質問によって知識ベースが検索され(右側の処理へ移行)，検索結果が自動編集され選択肢の形でユーザに提示される．ユーザの最初の質問が具体的な場合は，対話カードとはマッチせずに右側の処理へ移行し，はじめから知識ベースの検索結果が提示される．図中の各モジュールの働きは以下の通りである(詳細は次節以降に示す)．入力解析モジュール質問文を3種類の質問タイプ(Symptom型，How型，What型)に分類し，質問文の内容表現を抽出する．さらに，構文解析，キーワードと同義表現の抽出などを行う．テキスト検索モジュール対話カードおよび知識ベース(以下，これらを総称してテキストという)とユーザ質問文のマッチングを行い，スコアの高いテキストを返す．マッチングの際には，同義表現辞書，上位・下位語辞書を用いて表現のずれを吸収する．状況説明文抽出モジュール知識ベース中のユーザ質問文とマッチした文の，マッチした部分の周囲を抽出することによって，ユーザにとって簡潔でわかりやすい選択肢を提示する．</section>
  <section title="テキストの検索">質問応答システムにおいてまず重要なことは，質問の答えを含むと思われるテキストを十分な精度で検索できることである．そのために，質問タイプとプロダクト名による知識ベースの絞り込みを行う．また，表現のずれを吸収するために同義表現辞書(図)を利用したマッチングを行う．さらに，スコア計算において，「ファイル→開く」のような係り受け関係に加点することによって，検索の精度を向上させる．</section>
  <subsection title="マッチングの前処理">ユーザ質問文とテキスト内の文(以下，テキスト文という)は，それぞれ構文解析を行って文節単位の係り受け構造に変換した上でマッチングを行う．この節では，マッチングを行うまでの前処理についてまとめる．</subsection>
  <subsubsection title="構文解析とキーワード抽出">ユーザ質問文とテキスト文の両者について，JUMAN，KNPによって構文解析を行い，各文節に含まれるキーワードを抽出する．JUMANにおいて，普通名詞・固有名詞・人名・地名・組織名・数詞・動詞・形容詞・形容動詞・副詞・カタカナ・アルファベットと解析された語の原形をキーワードとみなす．ただし，一般的な語彙「する」「ある」「行う」「おこなう」「行く」「いく」「なる」「下さる」「くださる」「ございます」「できる」「出来る」は，キーワードとしない．</subsubsection>
  <subsubsection title="文節の分割・併合処理">マッチングのスコアを計算する際，KNPが出力した文節をそのまま用いることには問題がある．例えば，「画面をコピーできない」は2文節，「画面コピーをすることができない」は4文節と解析されるが，両者は同じことを表現している．これを適切に扱うためには，両者の単位をそろえる必要がある．本システムは，下記のルールに従って文節を分割・併合する(図)．複数のキーワードを含む文節は，1キーワード毎に分割する．分割された隣り合う文節同士は，係り受けの関係にあるものとする．ただし，カタカナ語・アルファベット・数詞が隣接している箇所では分割しない．このような語同士が隣接する場合は，「ウィンドウズ98SE」のようにプロダクト名などを表していることが多いからである．「(〜に)ついて」「(〜)こと」などの複合辞・形式名詞・副詞的名詞からなる文節，キーワードを含まない文節は，直前の文節に併合する．</subsubsection>
  <subsubsection title="否定フラグの付与">ユーザ質問文とテキスト文のマッチングの際に否定表現のバリエーションを吸収するために，文節にフラグを付与する．具体的には，形容詞「ない」，助動詞「ぬ」，または形容動詞「不可能だ」を含む場合に否定フラグを付与する(図右)．</subsubsection>
  <subsubsection title="ユーザ質問文のタイプ推定と文末表現の削除">「話し言葉検索」の検索ログを分析した結果，表に示すようにユーザの質問には主に3つのタイプが存在することがわかった．本システムでは，表の文末表現パターンを用いて，ユーザ質問文の質問タイプ(What型，How型，Symptom型，タイプなしのいずれか)を推定する．また，文末表現パターンのうち，「〜って何ですか」「〜方法を教えて」のようにテキスト検索においてノイズとなるものについては，ユーザ質問文から削除する．</subsubsection>
  <subsection title="表現のずれの吸収">適切なテキストを検索するためには，ユーザ質問文とテキストの間の表現のずれが大きな問題となる．本システムでは，同義表現辞書と上位・下位語辞書を用いることによってこの問題に対処する．</subsection>
  <subsubsection title="同義表現辞書">表現のずれは語のレベルだけでなく，「パソコンを起動する」「Windowsを起動する」「電源を入れる」のように，2文節以上のフレーズレベルにおいても多数存在する．そこで，同義語だけでなくフレーズレベルのものも含んだ同義表現をグループ化した同義表現辞書を作成し，これを用いて同義表現のマッチングを行う．同義表現辞書の例は図に示した．本辞書の作成は，「話し言葉検索」のログを解析し，頻出する同義表現をグループ化することによって行った．また，和語動詞(「戻る」など)の可能形(「戻れる」)や読み(「もどる」「もどれる」)も同義表現として登録した．なお，同義表現辞書には再帰的な関係が含まれているため，これをあらかじめ展開しておく．図においては，「メールを読む」には2つのキーワード「メール」「読む」が含まれるが，「メール」には同義語「メイル」「E-mail」が存在し，「読む」には同義語「読み込む」が存在する．この場合，「メールを読む」というフレーズを32=6通りに展開する．マッチングの際には，ユーザ質問文とテキストの両者について，同義表現辞書を調べて，そこに含まれる同義表現グループを抽出し，同一グループのものがあればマッチするとみなす．ただし，節で述べるように，テキストについてはあらかじめ同義表現グループを抽出しておく．図に，ユーザ質問文と同義表現辞書の照合の例を示す．この例では，4つの同義表現グループ[使う]，[メール]，[読む]，[メールを読む]が抽出される．</subsubsection>
  <subsubsection title="上位・下位語辞書">同義表現辞書ではうまく扱えない表現のずれも存在する．例えば，「ブラウザ」「IE6」，「ブラウザ」「IE5」といった表現のずれに対して，「ブラウザ」「IE5」「IE6」をすべて同義語として扱うことは問題である．なぜなら，「IE5」に関する質問に対して，「IE6」に関するテキストを示すことは適切でないからである．そこで，図に示すような上位・下位語辞書を作成し，テキストに現れるキーワードの上位語・下位語を，キーワードと同様に扱うことによってこの問題に対処する．例えば，「IE6」がテキストに現れる場合はその上位語「IE」「ブラウザ」もキーワードとして扱い，「IE」がテキストに現れる場合はその上位語「ブラウザ」と下位語「IE3」「IE4」「IE5」「IE6」もキーワードとして扱う．ユーザ質問文についてはこの扱いを行わないことによって，「IE5」と「IE6」がマッチすることが避けられる．</subsubsection>
  <subsection title="転置インデックスの利用">テキストを高速に検索するために，前もってテキストからキーワード・同義表現グループの抽出と，キーワードの上位・下位語の展開を行い，転置インデックスを作成しておく．本システムは，ユーザ質問文から抽出されたキーワードと同義表現グループについて転置インデックスを参照し，1個以上のキーワードまたは同義表現が一致するテキストを，次節で述べる質問タイプ・プロダクト名による絞り込みの対象とする．</subsection>
  <subsection title="知識ベースの絞り込み">テキスト検索の精度を向上させるために，質問タイプとプロダクト名による知識ベースの絞り込みを行う．</subsection>
  <subsubsection title="質問タイプによる絞り込み">テキスト検索モジュールは，入力解析モジュールによって推定された質問パターンにもとづいて，表に示すようにテキスト集合を絞り込む．原則として，用語集はWhat型，ヘルプ集はHow型の質問に対応させる．サポート技術情報についてはSymptom型・How型を示すタグが付与されているので，これを利用する．なお，What型の質問については必ずしも用語集を用いて答えればよいとは限らない．例えば，「コントロールパネルについて教えて」のような質問はWhat型に分類されるが，用語の定義ではなく操作方法などについて聞いていると解釈することもできる．よって，全てのテキストを検索対象とした上で，複数の知識ベースのテキストがユーザ質問とマッチした場合には用語集のテキストを最初に提示する．</subsubsection>
  <subsubsection title="プロダクト名による絞り込み">ヘルプ集・サポート技術情報については，図に示したようにすべてのテキストに対象プロダクト名が明示されているので，これを利用してテキストの絞り込みを行う．質問文にプロダクト名(WindowsNT，Word，Excelなど)が出現する場合は，そのプロダクトを対象とするテキストを検索対象とする．質問文に複数のプロダクト名が出現する場合(「Excelで作った表がWordで読み込めない」など)は，いずれかのプロダクトを対象とするテキストを検索対象とする．</subsubsection>
  <subsection title="テキストのスコア計算">転置インデックスを参照して得られ，さらに質問タイプ・プロダクト名によって絞り込まれた各テキストを対象として，ユーザ質問文との間で係り受け関係まで考慮した類似度計算を行う．ただし，絞り込まれたテキスト数が1000個を超える場合は，転置インデックスにおいて一致したキーワード・同義表現グループの数の多い順に，上位1000個までを対象とする．</subsection>
  <subsubsection title="文類似度の計算">ユーザ質問文とテキスト文の2文の類似度の計算は，節で述べた文節を単位として行う．2文の互いに対応する文節と係り受け関係の割合(被覆率)をそれぞれ計算し，その積を2文の類似度とする．まず，2文間で，以下の条件によって文節・係り受け関係を対応づける．その際，対応する文節・係り受け関係に対応度(0以上，1以下の値)を付与する．ユーザ質問文の文節Aに含まれるキーワードと，テキスト文の文節A'に含まれるキーワード(あるいはその上位・下位語)のいずれかが一致する場合，AとA'を対応づける．対応度は，以下のように計算する．	A，A'に共通のキーワードが含まれる場合は，以下の計算	式によって対応度を計算する．	[	(対応度)=(共通して含まれるキーワード数)(	]	例えば，「Windows98SE」(3語)と「Windows98」(2語)につい	ては，2語「Windows」「98」が共通して含まれるので，対応度は	2/3(0.67)となる．ただし，多くの場合，文節は1キー	ワードのみを含むので，対応度は1.0となる．	Aのキーワードと，A'のキーワードの上位語または	下位語が一致する場合は，対応度は0.9とする．	AとA'の否定フラグが一致しない場合は，対応度は	一致する場合の0.6倍とする．ユーザ質問文内の係り受け関係A$\rightarrow$Bとテキスト文内の係り受け関係A'$\rightarrow$B'について，文節A，A'と文節B，B'がそれぞれ対応する場合，それらを対応づける．A$\rightarrow$Bの対応度はA，Aの対応度とB，Bの対応度の積とする．ユーザ質問文から抽出された同義表現グループとテキスト文から抽出された同義表現グループが一致する場合，それらが抽出された文節・係り受け関係を対応づける(図)．対応度は1.0とする．以上の処理の結果，両者の文節・係り受け関係に対応度が付与される．複数の対応を持つ文節・係り受け関係については，いずれか大きな対応度をその対応度とする．ユーザ質問文，テキスト文の被覆率は，それぞれ以下の式によって計算する．[(被覆率)=(文節の対応度の和)+(係り受け関係の対応度の和)2(文節の総数)+(係り受け関係の総数)2]ユーザ質問文，テキスト文の両者の被覆率の積を，両者の類似度とする．図においては，ユーザ質問文，テキスト文ともに3つの文節と2つの係り受け関係が対応を持っており，対応度はすべて1.0である．両者の被覆率はそれぞれ1.0，0.54であるので，類似度は0.54となる．</subsubsection>
  <subsubsection title="テキストのスコアと代表文">各テキスト中でもっとも類似度の大きな文をテキストの代表文とし，その類似度をテキストのスコアとする．</subsubsection>
  <subsubsection title="サポート技術情報の扱い">サポート技術情報は，表に示したようにテキスト全体の複数文がマッチングの対象となるため，特別な扱いをしている．テキスト文の長さが一様ではないので，テキスト文の被覆率を考慮しない．すなわち，ユーザ質問文とテキスト文の類似度は，ユーザ質問文の被覆率とする．一つの事象を複数文で説明している場合が多いので，前後の文とのマッチングを考慮する．ユーザ質問文とテキスト文S_nの間で類似度を計算する場合は，ユーザ質問文の文節・係り受け関係と，S_nの前後の文(S_n-1，S_n+1)の文節・係り受け関係の対応にも，対応度0.5を与える．サポート技術情報のテキストには，図に示したように，セクションが存在する．これらのセクションのうち，「タイトル」「概要」「現象」「症状」セクションには，ユーザが頻繁に質問することがらが書かれていることが多い．そこで，文の存在するセクションに応じて，類似度に下記の係数を掛け合わせる．[	]</subsubsection>
  <subsection title="選択肢の絞り込み">テキスト検索モジュールは，3つのテキスト集合(用語集・ヘルプ集・サポート技術情報)ごとに，テキストのスコアに基づいてユーザに提示する選択肢を絞り込む．テキストをスコアの大きい順に整列し，上位n個までをユーザに提示する選択肢とする．ただし，スコアが閾値tを下回るものは対象外とする．また，同じスコアの複数のテキストがn位前後で並ぶ場合は，それらをすべて含める．n，tの値は，表に示すようにテキスト集合ごとに定めた．複数のテキスト集合から選択肢が得られた場合は，用語集，ヘルプ集，サポート技術情報の順で提示する．</subsection>
  <section title="ユーザのナビゲート">ユーザが自分の知りたいことを普通に表現しても，それで一意に適切なテキストが決まることは少ない．例えば「Windows98で起動時にエラーが発生した」という比較的具体的な質問であっても，いくつかの原因と対策があり，それぞれにテキストが存在する．ユーザの質問がさらに曖昧であったり抽象的であったりする場合には，より多くのテキストが候補として選ばれる．いずれにせよ，ユーザが，複数のテキスト候補の中から，自分の状況に一番適切なものを選択することが必要になる．WWWのサーチエンジンは，テキスト中から検索語を含む部分を抽出してユーザに提示することによって，ユーザのテキスト選択を補助している．本システムでは，この考え方を一歩進め，ユーザの質問(遭遇している問題)をより具体化するような説明文をテキスト中から自動的に抽出し，それらを選択肢として提示するという形でユーザへの聞き返しを行う．しかし，ユーザの質問が非常に曖昧な場合には上記の方法はうまく機能しない．そこで，頻繁に尋ねられる曖昧な質問に対して，それをどのように対話的に具体化するかを対話カードという形式で体系化した．例えば，図に示すように，ユーザが「エラーが発生した」という質問をした場合，「エラーが発生したのはいつですか」「使っているWindowsのバージョンは何ですか」などの聞き返しを行って，ユーザの問題を具体化する．</section>
  <subsection title="状況説明文の抽出">ユーザ質問とマッチした知識ベース中の文では，その中のマッチしなかった部分に，ユーザの問題をより具体化する状況説明が与えられていると考えられる(このような部分を状況説明文とよぶ)．たとえば，ユーザが「ページ違反が発生する」と質問し，これが「IE5を起動した際にページ違反が発生する」という文にマッチした場合，マッチしていない「IE5を起動した際に」という部分が状況説明文となる．ユーザの質問にマッチした複数の文からそれぞれ状況説明文を抽出し，ユーザに選択肢として提示すれば，ユーザは自分の状況に適合するものを容易に選択することが可能となる．状況説明文抽出のアルゴリズムを以下に示す．「この資料では，(〜)」「以下の」「(〜する)問題について説明しています」など，頻出する冗長な表現をパターンマッチにより削除する．文を次の箇所で分割する．分割された各部をセグメントと呼ぶ．	連用修飾節	「〜とき」「〜際」「〜場合」「〜最中」など	読点を伴うデ格セグメントのうち，すべての文節がユーザ質問文中の文節と対応するものを削除する(同義表現として対応する文節も含む)．末尾(削除されたセグメントを除く)のセグメントを状況説明文の核とする．核のセグメントと，それに直接係るセグメントのみを，状況説明文として選択する．アルゴリズムの適用例を図に示す．まず，左の文は2つのセグメントA・B，右の文は3つのセグメントC・D・Eに分割される．このうち，左の文のセグメントBと，右の文のセグメントC・Eは，すべての文節がユーザ質問文と対応するため削除される．結果としてセグメントAとDが状況説明文の核となり，「IE5を起動した際に」と「タスクスケジューラを使うと」が状況説明文として出力される．サポート技術情報のテキストについては，各選択肢テキストの代表文から状況説明文を抽出する．用語集・ヘルプ集のテキストについては，各テキストの見出し語・タイトル自体が簡潔な説明文となっているので，この処理の対象とはしない．</subsection>
  <subsection title="対話カードを用いた聞き返し">ユーザの質問が非常に曖昧な場合には，テキスト検索の精度が低くなり，多くの不適切なテキストがマッチしてしまう．このような場合に状況説明文の抽出を行っても，誤りを含んだ多くの選択肢が得られることになり，ユーザの助けとはならない．そこで，頻繁に尋ねられる曖昧な質問に対して，それを対話的に具体化する手順を対話カードという形式で体系化した．1枚の対話カードは，あるユーザ質問に対して，どのような聞き返しをすればよいかを記述したもので，以下の要素から構成されている(図)．対話カードの利用例を図によって説明する．まずユーザが「エラーが発生した」という質問をすると，質問文と各対話カードの&lt;UQ&gt;の部分とのマッチングを節で述べたアルゴリズムによって行う．この結果，図上段の対話カードが選ばれる．システムはこのカードに従って，「エラーはいつ発生しますか?」という聞き返しを，選択肢を示して行う．ユーザが「Windows起動中」を選ぶと，システムは図下段の[エラー/Windows起動中]の対話カードに移って，「あなたがお使いのWindowsを選んでください」という聞き返しを行う．ここでユーザが「Windows98」を選ぶと，「Windows98の起動中にエラーが発生する」を質問文として知識ベースのテキストの検索を行う．対話カードはこのように階層的に構成されており，そのすべてのカードの&lt;UQ&gt;が検索対象となっている．すなわち，図で示したさまざまなレベルの曖昧性・抽象度の質問を全体的にカバーするように設計されている．たとえば，ユーザが「Windowsを起動中にエラーが発生する」と質問した場合には，はじめから図下段のカードを用いた対話が行われることになる．また，対話カードの枠組みは，「U:こんにちはS:こんにちわ」「U:このシステム使いやすいですねS:ありがとうございます」のようなドメインとは関係のない例外的な対応を行う場合にも利用している(この場合は&lt;SEL&gt;のないカードとなる)．このような対応ができなければ，通常の検索，すなわち知識ベースに対して「このシステム使いやすいですね」で検索を行ってしまい，「システム」や「使う」を含む知識ベースを提示するということが起こってしまう．ユーザの例外的な発話に対する不適切な動作を防ぎ，正常な対話を維持するという意味で，対話カードによる例外処理は重要である(このような例外的な対話は次節では「範囲外」の対話と扱っている)．</subsection>
  <section title="評価">ダイアログナビは，http://www.microsoft.com/japan/navigator/において，2002年4月から公開サービスを行っている．ユーザとの質問応答のログは，対話データベースとして蓄積している．本システムの評価としては，対話セッションの評価，ユーザとシステムのふるまいの分析，状況説明文の抽出結果が妥当かどうかの評価の3種類を行った．</section>
  <subsection title="対話セッションの評価">対話データベース中の2002年8月1日〜31日の質問応答ログの中から無作為に300回のアクセスを選択した．それらを人手によってタスク指向対話としての意味的まとまりに分割した．このまとまりを対話セッションとよぶ．結果として，378個の対話セッションが得られた．1対話セッション当たりの発話ペア(ユーザのキーボード入力またはマウスでの選択と，それに対するシステムの応答)の回数は，平均1.42回であった．378対話セッションそれぞれに対して，評価者1名が次のいずれかの評価を与えた．本評価は，仮想的なテストセットによる評価とは異なり，実際にサービスを行った場面でのシステムのふるまいを正確にとらえている．しかし，不特定多数のユーザの真の意図に基づいて応答の適切さを判断することはできないという問題がある．そこで，対話セッションを以下の4つのタイプに分類し，それぞれのタイプについての評価のガイドラインを以下のように定めた上で評価を行った．評価の例を表表に示す．なお，表において，``U:''はユーザの発話，``S:''はシステムの発話を示す．また，``○''は評価者が「適切なテキスト」と判断したテキストを示す．タイプA:ユーザの質問が具体的で，適切なテキストの特定に必要な情報がすべて指定されている対話セッション(表)．この場合は，ユーザが指定した情報がすべて含まれているテキストを，適切なテキストであるとする．システムが提示した選択肢中に適切なテキストが存在する場合(A-1，A-2)は，「成功:知識あり」とする．その他の場合は，評価者がキーワード検索システムを用いて知識ベースを網羅的に検索し，適切なテキストが見つかれば「失敗:知識あり」(A-4，A-5)，見つからなければ「成功:知識なし」(A-3)または「失敗:知識なし」(A-6)とする．なお，ユーザがセッションの一部で曖昧な質問をしていても(A-2，A-4)，セッション全体として必要な情報がすべて指定されているときは，このタイプとする．タイプB:ユーザの質問が曖昧で，適切なテキストの特定に必要な情報が一部欠落している対話セッション(表)．対話カードが使用されたセッションは除く．この場合は，ユーザの状況に完全に合致するテキストはどれかを判断することはできないので，ユーザが与えた指定したすべての情報が含まれているテキストを，適切なテキストであるとみなす．ユーザの質問が1単語のみである場合(B-3，B-4)は，その単語が含まれるすべてのテキストを適切なテキストであるとみなす．タイプC:対話カードが利用された対話セッション(表)．この場合は，対話カードの最も下の階層までユーザが選択肢を指定し，かつ適切なテキストまたは選択肢が提示された対話セッションを，「成功:知識あり」と判断する(適切なテキストの判断基準はタイプAに準ずる)．対話カードの作成の際には，各々の選択肢に対応する質問文(phrase)に対して適切なテキストが提示されるかどうかをチェックしているので，適切なテキストが提示されないことはほとんどなかった．タイプD:ユーザの質問が想定ドメインの範囲外である対話セッション(表)．この場合は，対話カードを利用して応答したとき(D-1)と，テキストを検索した結果として該当する情報がないと応答したとき(D-2)は「範囲外:適切」，検索されたテキストを提示してしまったとき(D-3)は「範囲外:不適切」とした．*5mm表の右側(計の欄)に対話セッション評価の結果を示す．成功の割合は，「範囲外」を除いた230対話セッションのうち75,%であった．対話セッション内において対話カードによって応答が行われたかどうかと，対話セッションの評価の関係を表左側に示す．現在，対話カードの枚数は216枚(深さは最大で3階層)である．評価対象の対話セッション中，対話カードが利用された割合は，「範囲外」を除いて17,%(=38/(38+192))であり，対話カードが利用されたセッションの大部分は「成功」であった．また，範囲外の質問に対しても対話カードでカバーされている範囲ではほぼ適切に対応できており，全体として対話カードという枠組みは有効に機能していると考えられる．対話セッションの失敗の最も大きな原因は，知識ベース，同義表現辞書の不足である．ユーザ質問文に対して適切なテキストが存在しない場合，A-3のように適切なテキストがないことを判断するのは難しく，A-6・B-7のように誤ることが多い．かりに，表のスコア閾値tを大きくすればこの失敗を減らすことはできるが，その代償として適切なテキストが存在する場合の「成功:知識あり」が減って，「失敗:知識あり」が増えてしまう．A-5・B-6のような「失敗:知識あり」を減らすには，同義表現辞書をより充実させ，適切なテキストを大きなスコアでマッチさせる必要がある．また，A-4のように，対話のコンテキストを考慮していないために失敗した対話セッションもあった．この種の失敗を減らすには，コンテキストを考慮したテキストの検索を行う必要がある．なお，同義表現辞書と，例外処理的な対話カードについては，対話データベースで顕著なものについて随時データの修正・作成を行っている．このことによって，公開当初の成功率は60,%程度であったが，徐々に改善され，現在では表で示したとおり70,%を越える成功率となってきている．</subsection>
  <subsection title="ユーザとシステムのふるまいの分析">前節で述べた378対話セッション内において，ユーザがどのような行動をしたか，システムがそれに対してどのような応答を行ったかを調べた(図)．ユーザの質問文の入力(518回)のうち，対話カードによって応答されたものは19,%(=(32+66)/518)であった．また，質問文の長さとシステム応答の関係(表)を調べたところ，対話カードは，主として短い質問文(3文節以下)に対応していることがわかった．一般的には，短い質問文ほど曖昧である．よって，図のユーザ質問のhierarchyにおいて，上の方の曖昧な質問文に対応するという対話カードの枠組みは，有効に機能していると考えられる．また，ユーザ質問文の長さと知識ベースの検索結果の関係(表)も調べたところ，適切なテキストの割合は，質問文が長いほど少ないことがわかった．一般的には，長い質問文ほど専門的なものが多い．よって，知識ベースはそのような質問文を十分カバーしていないと考えられる．一方，ユーザ質問文の長さとテキスト数(ユーザに提示した選択肢の数)の関係については，ユーザ質問文が1文節の場合のテキスト数が特に多かった．これは，B-3の対話セッションのようにユーザが入力した1キーワードを含むテキストを多数提示してしまうことが多かったのが原因である．一方，質問文がある程度長い場合は，選択肢の絞り込みのパラメータ(表)によって，ユーザへの聞き返しとして適切な数に絞り込まれている．</subsection>
  <subsection title="状況説明文抽出の評価">2002年8月1日〜31日の対話データベースから，5つ以上の選択肢が返されたユーザ質問文をランダムに100個選んだ．さらに，選択肢中で上位5個中にランキングされているサポート技術情報の状況説明文を，評価者1名が「妥当」「不十分」「冗長」の3段階で評価した．上位5個中において，タイトルが代表文として選ばれている152個のテキストは，代表文がそのまま状況説明文となるため除外した．結果として，348(=1005-152)個の状況説明文が評価の対象となった．状況説明文の評価は，ユーザが選択肢を選ぶために必要十分な情報を，それぞれの選択肢が含んでいるかどうかという観点から行った．具体的には，まず質問文に対する選択肢(5個)どうしを比較し，どの情報が選択肢を選ぶ上で最も重要かを判断する(この情報を，最重要情報とよぶ)．さらに，各々の選択肢について，以下のいずれかの評価を与える．妥当:最重要情報が過不足なく含まれている．不十分:最重要情報が含まれていない．冗長:最重要情報以外の情報が著しく多く含まれている(目安としては，最重要情報以外の情報の文字数が，最重要情報の文字数の1/2を超えるとき)．表に状況説明文の評価結果を示す．抽出された状況説明文のうち，61,%は妥当なものであった．また，状況説明文の平均文字数は68.9文字，状況説明文の抽出対象となった各テキストの代表文の平均文字数は81.6文字であった．したがって，提案手法による代表文の圧縮率(=(1-状況説明文の平均文字数/代表文の平均文字数)100)は15.6,%であった．表に状況説明文の評価の例を示す．この例においては，評価者は，「音が出ない具体的な環境(サウンドデバイス名，アプリケーション名，ファイルの種類など)」が最重要情報であると判断した．2番，5番の選択肢は，再生するファイルの種類を過不足なく述べているため，「妥当」と判断した．一方，4番の選択肢は，サウンドデバイス名を含んでいるものの，それ以外の発生条件や，「非常に音が小さい」といった情報を余分に含んでいるため，「冗長」と判断した．提案手法による代表文の圧縮率が比較的小さかったのは，「冗長」な状況説明文が多いのが大きな要因であった．具体的には，表の4番の選択肢のように，ユーザが選択肢を指定する上で重要な情報を含まないセグメントが，削除されずに状況説明文に含まれてしまったものが多かった．より適切な選択肢を得るためには，選択肢の代表文どうしを比較して何が最も重要な情報かを認識し，それを優先して選択肢に含める一方，それ以外の情報は除外することが必要である．また，4番の選択肢では，「非常に音が小さい」と「音が出ない」を並列節として扱うことによって，両者がともに聞き返しにとって冗長であることを認識して削除する必要がある．「不十分」と評価された状況説明文については，状況説明文抽出の対象となるテキストの代表文(項)がテキストの内容をよく表していないものが多かった．これは，主にユーザ質問文とテキストのマッチングに関する問題である．しかし，テキストの中には，ユーザ質問文とマッチする1文だけを抽出しても，良い代表文が得られないものもある．例えば，ユーザが遭遇する問題(「エラーが発生する」など)と，ユーザの具体的な状況(エラーメッセージなど)が，それぞれ別々の文に書かれている場合は，提案手法はうまくいかない．このような場合は，文脈解析などのより深い言語処理が必要となる．</subsection>
  <section title="おわりに">本論文では，大規模テキスト知識ベースを利用する対話的質問応答システムを提案した．システムを実際に運用し，得られた対話ログに基づいてシステムの評価を行い，対話セッションの成功率76,%，妥当な状況説明文の割合61,%という結果を得た．また，曖昧な質問への聞き返しとして対話カードと状況説明文の抽出を組み合わせて用いる本システムの枠組みは，有効に機能していることを示した．今後の課題としては，対話カードの自動的な作成と，対話のコンテキストの利用があげられる．対話カードの作成は，現在はすべて人手で行っているが，曖昧な質問を十分にカバーする対話カード集合の構築にはコストがかかるので，自動的に作成する手法が必要である．また，対話のコンテキストの利用については，収集した対話ログをより詳細に分析することで，研究を進める予定である．document</section>
</root>
