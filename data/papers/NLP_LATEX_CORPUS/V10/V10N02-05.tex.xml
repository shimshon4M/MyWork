<?xml version="1.0" ?>
<root>
  <title>LexicalFunctionalGrammarに基づく実用的な日本語解析システムの構築</title>
  <author>増市博大熊智子</author>
  <jabstract>本稿では，LexicalFunctionalGrammar(LFG)に基づいた実用的な日本語文解析システム構築に向けての日本語LFG文法記述の詳細とシステムの評価について述べる．本稿で述べる日本語LFG文法は，(1)解析対象が口語的・非文法的文であっても解析可能な高いカバー率を持つ，(2)言語学的に精緻な文法規則を持ち豊富な意味情報を含むf-structureを出力可能とする，(3)f-structureの持つ言語普遍性の特徴を活かすため他言語のLFG文法と高い整合性・無矛盾性を保つ，の3点を特徴とする．自然言語の文法記述を完全に体系的・手続き的に進めることは困難であり，本稿で述べる文法記述においても経験的なものに依存する面は大きい．しかしながら，OTマークを利用して段階的に解析を行う手法によって，例外的な文法・語彙規則が解析結果に及ぼす悪影響を減じ，文法の大規模化に伴う記述の見通しの悪さを軽減することが可能となった．さらに，部分解析機能の導入によって，口語的・非文法的文への対処が可能となった．マニュアル文のような文法に則った文と，お客様相談センター文のような口語的な文の両者を対象に解析実験を行い，日本語LFGに基づくシステムとしてはこれまでにない，95,%以上の解析カバー率が得られていることを確認した．また，マニュアル文を対象に解析精度測定のための評価実験を行い，係り受けの再現率・適合率共に平均値で約84,%，上限値で約92,%の値が得られていることが確認できた．</jabstract>
  <jkeywords>語彙機能文法，LFG，日本語文法規則，構文解析</jkeywords>
  <section title="はじめに">言語処理において，宣言的な文法規則に基づく自然言語文解析の研究・開発は不可欠のタスクである．本稿では，LexicalFunctionalGrammar(LFG)に基づいた実用的な日本語文解析システムについて述べる．本システムの第一の特徴は，精緻な日本語文法規則に基づく深い解析を行う点である．第二の特徴は，実文を対象とした評価が可能な高い解析カバー率を達成している点，すなわち，解析対象が口語的・非文法的文であっても解析可能な高い頑健性を持つ点である．本システムの実装により，LFGに基づく日本語解析システムとしては初めて，文法機能(grammaticalfunction)の情報を含めた解析精度の評価実験を行うことが可能となった．さらに第三の特徴として，LFGの解析結果が持つ言語普遍性の特徴を活かすため，他言語のLFG文法と高い整合性・無矛盾性を保っている点を挙げることができる．第一の特徴を実現するために，日本語文法あるいは国文法研究の知見を参考にして，LFGのフォーマリズムに基づく大規模な文法記述を行った．もちろん，言語現象の形式化には様々な選択肢がある．本システムの構築に際しては，上記第二の特徴および第三の特徴を実現するために，(1)一般には非文法的とみなされる文であってもそれを排除する選択肢を採用せず，かつ，(2)他の言語の解析結果との並行性を保持できる選択肢を優先する方針で文法規則の記述を行った．本稿の構成は以下の通りである．2章では，LFGおよび関連研究について述べる．3章では，上記第三の特徴に関係する取り組みとして，我々が属しているParallelGrammarProjectでの活動を概観する．4章で，日本語LFGシステムの構成を説明した後，5章では文法記述について述べる．5.1節および5.2節において，上記(1)(2)の方針で記述した日本語文法規則を説明する．5.3節の冒頭で触れている通り，第一の特徴と第二の特徴を両立することは極めて難しい．5.3節では，OTマークと部分解析の機能を用いて，この両立を実現する手法について述べる．6章では，以上の枠組みで構築した日本語LFGシステムの評価結果を示し，7章に今後の課題を記す．</section>
  <section title="Lexical Functional Grammar">LFGは自然言語文の解析を行うための文法理論であり，によってその概念が提唱された後，によって現在の形の定式化が完成した．LFGに基づく解析では，解析結果としてc(onstituent)-structureとf(unctional)-structureと呼ばれる2種の構造を出力する．c-structureは自然言語文の構造を，文の形態素を上位のフレーズへと纏め上げることによって木構造として表現するものである．一方，f-structureは，文法機能の概念に基づき，文の格構造，時制，様相，話法等の意味情報を属性-属性値のマトリックス構造で表現するものである．LFG理論では，SUBJ(ect)やOBJ(ect)等の文法機能をいかなる言語の解析においても有効であると考え，第一義の未定義要素としての地位を与えている．すなわち，見かけの表現は全く異なっていたとしても，文法機能の概念はあらゆる言語において共通に存在するという立場をとる．この立場は，ArcPairGrammarやRelationalGrammar，ConstructionGrammarと共通するものである．言語が異なれば同じ意味内容を表現する文であってもその句構造すなわちc-structureは大きく異なる一方で，文法機能に基づく構造であるf-structureの違いは多くの場合極めて小さいことが知られている．言語解析システムの出力結果が言語を問わず一定であればあるほど，多言語を対象とする言語処理システムの構築に要するコストは低減すると考えられる．このような工学的観点からみると，f-structureの言語普遍性は，f-structureを中間言語とする機械翻訳システムはもとより，質問応答，自然言語によるマンマシンインタフェース，文書集合の内容一貫性保持等の自然言語処理アプリケーションを言語の壁を越えて実装する上で重要な特徴であるといえる．1章で述べた通り，本稿で述べる日本語LFG文法では，このf-structureが持つ言語普遍性の特徴を損なわないことを記述方針の一つとしている．これまでも，LFGやHead-drivenPhraseStructureGrammar(HPSG)等の単一化文法に基づいた日本語の解析に関する研究は数多く行われている．しかし，比較的最近まで，f-structureのような素性構造の単一化は大きな計算量を要する作業であるため，大規模な文法を用いた解析の実行は困難であるとの認識があった．さらに，単一化文法の枠組みにおいて，日本語の文法事項を網羅的に含み高いカバー率を実現する文法規則を記述することは容易ではないと指摘されている．しかしながら，前者の解析効率の問題に関しては，，等で提案されている解析アルゴリズムの進展によって一定の解決策が得られつつある．また，この前者の問題の解決は，後者の問題とも大きく関係している．単一化に基づく解析を実行するシステムは制約充足問題を解決するシステムである．制約数すなわち文法規則の数が多くなるにしたがって計算量の爆発が生じる．前者の問題が解決されていないこれまでの状況においては，システムの制約上，大規模な文法を記述し試すことが困難であったため，高い解析カバー率を持つ文法の構築に焦点を当てた研究には至らなかった．前者の問題が解決される過程にあり，大規模文法の記述に挑戦できる状態になってきたのが現在の状況であるといえる．例えば，では，意味表現出力を伴わないものの極めて高い解析カバー率を持つ日本語HPSGシステムの報告がなされている．一方，では，カバー率の問題は残るものの日本語文法の知見に立脚した精緻な解析を行うJapanesePhraseStructureGrammar(JPSG)システムの構成手法が提案されている．</section>
  <section title="Parallel Grammar Project">我々は，ParallelGrammar(ParGram)と呼ばれるプロジェクト活動の中で日本語LFG文法の記述を行っている．ParGramは，LFGを共通の理論基盤として英語，ドイツ語，フランス語，ノルウェー語，ウルドゥー語，デンマーク語そして日本語の各言語を解析するシステムの実現を目標としている．ParGramでは，半年に一度全言語の文法記述担当者が集まってミーティング(ParGramMeeting)を開催し，複数言語間でf-structureの整合性を可能な限り高める，あるいは，矛盾を回避する機会を継続して持つことにしている．すなわち，f-structureの構成から属性・属性値の用法やネーミングコンベンションに至るまでの詳細を議論し，ParGramの標準仕様を決定する作業を行っている．日本語LFG文法における，肯定文，否定文，疑問文，受動文，並置表現等の基本的な構文に対して出力されるf-structureは，このParGram標準仕様に準じている．ただし，この標準仕様は，f-structureの基本的な構成，属性・属性値については全言語でほぼ合意がなされているが，詳細な文法事項に関しては現在も継続的に議論を続けている．例えば，属性のネーミングレベルの仕様に関しては，当初全言語で性別を示す属性として使用していた「GEND」を，英語と日本語のLFG文法では「GEND-SEM」とし，「GEND」と区別するよう変更を行った．英語と日本語の文法では代名詞に対して「GEND」属性を与えていたが，これはドイツ語，フランス語，ノルウェー語，ウルドゥー語の一般名詞が持つ性別の概念とは本質的に異なるためである．図に，文（1-a）に対して日本語LFGシステムが出力するf-structureを示す．SUBJおよびOBJのPRED(icate)に自立語(「ジョン」「本」)が挿入されているのに対して，OBL(ique)のPREDには格助詞(「ニ」)が挿入されている．これは，英語等のParGramが対象とする欧米言語において，SUBJおよびOBJに対応する自立語が前置詞を必要としないのに対して，OBLやADJUNCTは前置詞を伴うことに由来する．日本語内での整合性だけを考えれば，SUBJやOBJのPREDも格助詞とする，あるいは，OBLやADJUNCTのPREDも自立語とする，という文法を記述することが可能である．しかしParGramにおいて他言語との整合性（比較のしやすさ）を重視するという立場から，図に示したf-structureを出力する方針で文法記述を行った．図は，ParGramの英語LFG文法を用いて文(1-a)に対応する英語文（1-b）を解析した結果得られるf-structureである．基本的に図と等しい構造を持っていることが分かる．なおc-structureに関しては，ノード(grammaticalcategory)名に対する緩やかなネーミングコンベンションの取り決めはあるものの，どのような構造を定めるかは各言語の担当者に任されている．図，図は，文(1-a)(1-b)を解析した結果得られるc-structureである．両者の構造は全く異なっていることが分かる．</section>
  <section title="システム構成">ParGramでは共通のプラットフォームとしてXeroxLinguisticEnvironment(XLE)と呼ばれるLFGの処理系を使用している．XLEはLFG理論の仕様をほぼ完全に実装したparserであると同時に，LFGの文法記述を行う際のデバック環境であり，かつ，f-structureから自然言語文を生成するgeneratorでもある．XLEが持つ最も重要な特徴はその解析速度である．LFGでは，c-structureを構成するための句構造規則(文脈自由文法規則)と，f-structureを構成するために句構造規則(の右辺の各構成素)に付与する機能的注釈(functionalannotation;functionalschemata)を同時に記述する．XLEは，句構造規則に基づく解析処理を実行した後に，処理が必要な機能的注釈を動的に決定する．すなわち，計算量の大きい機能的注釈の処理を選択的に行うことによって解析速度の向上を実現している．また，解析結果の排他性・独立性を考慮した単一化手法も高い解析効率に寄与している．XLEを採用することによって，大規模なLFG文法に基づく解析を実時間で行うことが可能となった．図5は，日本語LFGシステムの構成図である．まず日本語入力文が形態素解析システムに渡され，得られた形態素解析結果から入力文語彙規則を生成する．形態素解析システムには茶筌を使用している．語彙規則生成部は，約40種の語彙規則テンプレートを持ち，適切なテンプレートを選択して必要項目を埋めることによって，各形態素の語彙規則を動的に生成する．テンプレートの選択は，各形態素の品詞および前後の形態素の品詞を基に，予め作成したルールによって行う．また，形態素解析処理によって得られた形態素列はXLEへの入力となる．活用語については，終止形をXLEへの入力とし，活用形は「M__」(命令形)，「K__」(仮定形)，「Y__」(連用形)等の特別な文字列を形態素相当としてXLEへ渡す．なお，連用形を示す文字列は必要に応じてXLEへ渡すことにした．後続する語が自立語ならば，その活用形が句複合を行う結合子など何らかの統語的役割を果たしていると判断し，その目印として文字列を挿入する．一方，後続する語が助動詞などの付属語ならば挿入を行わないことによって，文法規則を簡略化する．XLEによる入力形態素列の解析には，上記の入力文語彙規則に加えて，予め用意した基本語彙規則，動詞語彙規則，形容詞語彙規則，形容動詞語彙規則，および，文法規則を使用する．動詞語彙規則，形容詞語彙規則，形容動詞語彙規則は，IPAL辞書の結合価情報をベースに拡張を行い，LFGの規則として必要な記述を追加したものである．現在のところ，動詞語彙規則は2,366の異なり語彙に対して10,387の語彙規則(41,115の機能的注釈)を含んでいる．形容詞語彙規則および形容動詞語彙規則は，それぞれ302および67の異なり語彙に対して810，137の語彙規則(1,891，306の機能的注釈)を含んでいる．基本語彙規則は，助詞，助動詞，代名詞，接続詞等の基本語彙に加え，接続助詞的な働きをする「間」「時」といった名詞等，統語上重要と考えられる語の語彙規則を独自に記述したものである．現状では，407の異なり語彙に対して954の語彙規則(1,233の機能的注釈)を含んでいる．文法規則のサイズは，積和標準形に変換した場合の項の総計が2,353であり，1,223の機能的注釈を含む．文法規則の詳細は次章で説明する．なお，語彙規則の中で，入力文語彙規則の優先順位は他の語彙規則よりも低く設定してある．つまり，入力文語彙規則は，同じ語彙に対する規則が既に存在している場合上書きされることになる．これは，助詞，助動詞などの重要な統語的役割を担う語に関しては，形態素解析結果から動的に生成されるデフォールトの規則よりも精緻な記述が必要となるからである．同時に，形態素解析の品詞付け誤りを吸収するための措置でもある．例えば，格助詞の「デ」と助動詞「ダ」の連用形「デ」の違いを形態素解析レベルの処理で正確に判別することは困難である．そこで，基本語彙規則中の「デ」に対して，格助詞としての振舞いを記述する規則と，「ダ」の連用形としての振舞いを記述する規則の両者を含めておく．形態素解析処理によって付与された品詞の如何にかかわらず，語彙規則としては双方の可能性を残して解析を進める．最終的には，その中から文法規則に従う解析結果のみが残ることになる．</section>
  <section title="日本語LFG文法記述"/>
  <subsection title="基本的な文法規則">日本語の典型的な特徴として，語順の制約が緩い点(freewordorder)，主語や目的語といった文の必須構成要素の抜け落ち(ゼロ代名詞)が頻出する点，および，複合述部(complexpredicate)が多用される点を挙げることができる．本節では，これら日本語の基本的な性質に対応するために我々が記述したLFG文法規則について述べる．日本語がfreewordorderの特徴を持つことは明らかである．ただし，文(2-a)と文(2-b)を比較すると(2-a)がより自然な文であると感じる．すなわち，基本的には各文に最適な語順が存在すると考えられる．文(3)および(4)は語順の点で不自然な文であり，最適順序性を考慮してこれらの文を解析対象外とする方針を採ることは可能である．例えば，では語順を強く意識した文法記述を行っている．しかし，文(2-a)と文(2-b)が表現する意味内容に違いがないことから，我々の日本語LFG文法では上記の最適順序性を考慮せず，どちらの文に対しても図に示すf-structureを出力するよう文法記述を行った．これは1章で述べた高いカバー率を達成する上でも重要な記述方針である．実際には，文(3)や(4)のように語順が不自然な文が現れることは珍しくない．したがって、高い解析カバー率を得るために，最適順序性に依存することのない，以下のような文法規則を日本語LFG文法の基本規則とした．句構造規則が「文Sは任意個の後置詞句PPとそれに後続する述語Vから構成される」ことを定義し，機能的注釈によって「Vが文全体のPREDを担い，PPがそれに下位範疇化される文法機能を担う」ことが定義されている．なお，以下本稿の文法規則の説明で用いる記号(grammaticalcategory名)は，実際に使用している文法・語彙規則中の記号とは必ずしも一致していない．また，係助詞や副助詞によって格助詞が省略されている場合，文法的に可能性のある解析結果を全て出力するという方針で文法記述を行った．したがって文(5)に対しては，「花子」がSUBJで「本」がOBJの解析結果と，その逆の解析結果の両者を出力する．解析結果を一つに絞り込む機能は重要であり，これを行うために意味素性および選択制限の概念を文法・語彙規則に取り入れる余地はある．しかし，直前の文が(6-a)の場合と(6-b)の場合でSUBJとOBJが逆になる文(6-c)の例から分かるように，文単位の解析では本質的に曖昧性を解消できない場合もある．したがって，現在のところ文法的に誤りのない解析結果は全て出力し，曖昧性の解消は文脈解析等の別処理に委ねるという立場をとっている．もちろんこれは，格助詞・係助詞に関わるいかなる曖昧性の解消も行わないということを意味するものではない．例えば，(7-a)の名詞句と(7-c)の文は共に文法に則った表現であり「読む」のSUBJは「太郎」である．しかし，(7-d)の文では「太郎」は「捨てる」に係る．同様に，(7-b)の名詞句と(7-c)の文は共に文法に則った表現であるが，(7-e)の文において「太郎」をSUBJと解釈することはできない．前者は，(I)「関係節内において係助詞「ハ」による主題化は起こらない」，後者は，(II)「関係節内においてのみ格助詞「ノ」による主格表示が可能である」という文法規則に一般化できる．我々は，(7-d)および(7-e)の解析結果に曖昧性が生じない(「太郎」が「読む」のSUBJとなる解析結果を生成しない)よう，(I)(II)を実現する文法記述を行った．（(7-e)に対しては，「読む」のSUBJはnullであり「太郎」は「本」の連体修飾成分となる解析結果が得られる．）(I)(II)を表現するためのLFG文法規則を以下に示す．文の必須構成要素が抜け落ち可能であるというゼロ代名詞の問題に関しては，述語(語彙規則)の結合価情報を利用する．結合価に対応する要素が文中に存在しない場合，省略があると判定する．ただし，このように結合価を埋める要素(下位範疇化すべき要素)がない場合，LFG理論のCompletenessの条件を満たすことができず，したがってf-structureを構成することができない．そこで，省略された要素のPREDに代名詞を示す'pro'を代入しPRON-TYPEの属性にnullを挿入することによって省略を表現し，f-structureを構成する．以上のことを実現する語彙規則を，「読む」を例として以下に示す．「PD」および「DEFAULT」はマクロ定義であり，「＠」はマクロの呼び出しを表す．語彙規則に「@(PDSUBJ)」を付加することにより，SUBJのPREDに'pro'が，SUBJのPRON-TYPEにはnullが代入される．「DEFAULT」マクロ中の「ProDrop:OT」は，「ProDrop」という名前のOTマークの定義である．OTマークは規則に対して優先順位を付与する働きを持つ．詳細は5.3.1項で説明する．ProDropには低い優先順位を設定し，それによって，「読む」が下位範疇化すべき要素がない時に限り「@(PDSUBJ)」および「@(PDOBJ)」が機能する．一般に，OTマークを利用することによって，解析結果の曖昧性を言語学的な根拠のもとに減少させることが可能となる．この記述手法の導入によって，省略要素を適切に同定することが可能となり，欧米言語では問題になることの少ない必須構成要素の抜け落ち問題を解決することができた．主語や目的語の省略は日本語では極めて頻繁に起こるため，この語彙規則記述は，解析カバー率向上にとって重要な役割を果たすものであるといえる．日本語のcomplexpredicateの取り扱いについても様々な方針が考えられるが，我々は，複数のPREDを立てる解析，すなわち，f-structureの入れ子構造によってcomplexpredicateを表現する解析(multi-clausalな解析)を行わない．複数のpredicate-argument構造の存在が同時に認められる場合(5.2.1項)を除き，mono-clausalな解析を行う．時制，様相等の情報はf-structure中のPRED以外の属性で表現する．例として，文(8)のc-structureとf-structureを図，図に示す．日本語のcomplexpredicateの構成は極めて多様であり，口語的・非文法的な文も含めて構成規則を網羅的に記述することは事実上困難である．したがって，高い解析カバー率を実現するために，complexpredicateに対応する規則はこのような緩やかなものとする方針を採っている．</subsection>
  <subsection title="特徴的な文法規則">本節では，日本語LFG文法で記述されている文法規則の中から1章で述べた高い解析カバー率および他言語との整合性の実現に関わるものを取り上げ，その記述方針を説明する．</subsection>
  <subsubsection title="受動文・使役文の取り扱い">前節では，複合述部の取り扱い方針としてmono-clausalな解析を採用すると述べた．しかし，複数のpredicate-argument構造を持つと認められる間接受動文(いわゆる「迷惑の受身」)と使役文については，bi-clausalな解析結果を出力するよう文法記述を行った．文(9)は間接受動文の例である．文(9)には，「「私」が「れる」」に加え，「「雨」が「降る」」という2つのpredicate-argument構造が含まれている．これを示すため，bi-clausalな解析を行う文法記述を行った．文(9)のf-structureを図に示す．文(10-a)は使役文の例である．文(10-a)には，「「花子」が「太郎」に「せる」」と，「「太郎」が「次郎」を「殴る」」という2つのpredicate-argument構造が認められるため，同様にbi-clausalな解析を行っている．文(10-a)のf-structureを図に示す．使役の助動詞「セ」「セル」に準ずるものとして，「頂く」「貰う」等の補助動詞も同様に取り扱っている．この記述方針は他言語のf-structureとの整合性を図る目的に従うものでもある．文(10-a)に対応する英語文(10-b)のf-structureを図に示す．基本的に図と等しい構造であることが分かる．</subsubsection>
  <subsubsection title="副助詞の取り扱い">副助詞は文脈情報を担うものであるため，意味情報を扱う解析において極めて重要な形態素であるといえる．さらに日本語文に頻繁に出現するため，副助詞を取り扱う文法規則は高いカバー率を実現する上でも重要なものである．しかしながら，これまでの実システムにおいて副助詞の振る舞いを十分に考慮した文法記述がなされてきたとは言い難い．水谷文法では，副助詞を体副形成子として規定する．これは，副助詞が，副詞化可能な体言を形成する働きを持つことを意味する．例えば文(11-a)(11-b)のように「太郎が来る」が副助詞「まで」を伴うと，名詞的あるいは副詞的働きを持つようになる．本システムでは，このような副助詞の性質を表現する文法の記述を行っている．ただし，文(12)のように副助詞(「さえ」)が格助詞に後続する場合は，に倣い格表示の一部とみなして体副形成子とは異なる扱いをする．図，図に文(11-a)(11-b)のf-structureを示す．なお，図中の「_5」は5.2.3項で述べる助詞の無形表示を示す記号である．</subsubsection>
  <subsubsection title="助詞・助動詞の無形表示の取り扱い">は，形容詞の連用修飾に曖昧性があることを指摘している．例えば文(13-a)は2つの解釈が可能である．1つは「子供が優しくなるように育てる」という意味であり，これは「優しい」が「育てる」という動詞の帰結状態を示している．もう1つは「子供の育て方が優しい」という意味であり，「優しい」は「育てる」の情況を示している．(13-b)との比較から分かるように，(13-a)において帰結状態を示す「優しい」は格助詞「ニ」を伴う後置詞句相当の働きを担っている．しかし，(13-d)が非文であることから分かるように，単なる格助詞「ニ」の省略とはみなせない．はこのような無形表示に対して零記号を導入することによって整合性の高い国文法体系を構築している．では帰結状態を表す零記号を「_4」と定義する．我々もこれに倣い，以下の文法規則によって，帰結状態を示す無形表示を「_4」で表現した．一方，情況を表す「優しい」は情況語(副詞)と定義し，f-structure中ではADJUNCTとして表現する．文(13-a)の帰結状態の解釈に対応するf-structureを図に，情況の解釈に対応するf-structureを図に示す．また，(13-b)(13-c)に対応するf-structureを図，図に示す．図と図，図と図がそれぞれ同等の構造を持っていることが分かる．この記述方針も5.2.1項同様，他言語のf-structureとの整合性を図る目的に従うものである．文(13-a)の2つの解釈に対応する英語文(14-a)(14-b)のf-structureを図および図に示す．基本的にそれぞれ図および図と等しい構造であることが分かる．その他，名詞(サ変動詞語幹を除く)で終わる文(新聞見出し等)に対応するため，名詞句に後続する助動詞(「ダ」「デス」等)の省略を零記号「_1」で表現している．また，埋め込み句が連用修飾を行う際の助詞の省略を「_5」で表現している．以上本節では，言語現象の具体例を通して日本語LFG文法の特徴を示した．表に，これまでに実装した文法規則の主なものを示す．ただし，に記述されている基本的な文法事項に対する文法規則および本稿で説明済みの文法規則は省略した．</subsubsection>
  <subsection title="例外的な文法に基づく文・非文法的文への対応">高い解析カバー率を達成するためには，例外的な表現を含む文や非文法的な文を解析できなければならない．LFGに基づく解析によってf-structureを得るためには，入力文の構文に対応する句構造規則および機能的注釈が全て宣言的に記述されている必要がある．しかしながら，例外的な事項を網羅的に記述すると，正しい解析結果と同時に不適切な解析結果も多数出力されてしまい，精度を下げることになる．さらに，前節までに述べたような文法記述をどれほど精緻化したとしても，必ず解析不能な文が残るという問題もある．本節では，これらの問題を回避しシステムの頑健性を高めるための手法として，OTマークと部分解析について述べる．</subsection>
  <subsubsection title="OTマークの利用">日本語LFG文法では，各機能的注釈に対して，OptimalityTheoryに基づいたマーク(OTマーク)を付与している．OTマークには予め優先順位を設定しておく．優先順位の高いOTマークが付与された機能的注釈に基づいて得られたf-structureを優先的に最終結果に残す．すなわち，各OTマークが固有のコストを持ち，文全体のコストが最小となる解析結果を優先する．5.1節で述べたようにOTマークを付与する本来の目的は言語学的な根拠に基づいて解析結果の曖昧性を減少させることである．我々もこの目的のためにOTマークを使用し，解析結果数の爆発を防いでいる．しかし，我々の文法では，それと同時に，例外的な文法事項を見通しよく記述するためにもOTマークを利用している．現在約40種類のOTマークをLevel1-4の4つのグループに分けて使用している．Level1に属するOTマークが最も優先順位が高く，Level4のOTマークが最も低い．もちろん，解析結果の曖昧性解消の目的で，同じグループに属するOTマークの間にも細かな優先順位の違いを設定している．なお，OTマークが明示的に付与されていない機能的注釈には，Level1に属するOTマークが付与されているとみなして処理を進める．まずLevel1のグループに属するOTマークを持つ機能的注釈のみを用いて解析を行う．f-structureが得られれば解析を終了する．得られなければ，Level1に加えてLevel2に属するOTマークを持つ機能的注釈も用いて再度解析を行う．これを繰り返し，解析結果が得られるまで，優先順位の低いグループに属するOTマークを持つ機能的注釈を順に加えて解析を行う．我々は，文法・語彙規則が例外的なものであるほど，低い優先順位のグループのOTマークを付与している．これによって，例外的な文法・語彙規則が通常の解析結果に悪影響を与えないようにすることができる．例えば，文(15-a)(15-b)から分かるように通常格助詞が動詞の終止形に直接後続することはない．しかし，文(15-c)のような特に慣用的な表現においては非文法的な表現とは言えない．我々は，動詞の終止形の直後に格助詞が後続することを許す文法規則(機能的注釈)に対してLevel4のOTマークを付与している．2章で述べた通り，LFGに基づく文法・語彙規則は制約の集合である．文法記述が大規模になるにつれ，規則が解析結果にいかに影響するかを網羅的に把握することが困難になり，予期せぬ副作用が生じてしまう可能性が高くなる．本項で述べたOTマークを利用した多段階の解析手法は，このような文法記述の本質的な困難さを低減し，副作用の影響を受けずに例外的な文法・語彙規則を付加していく上で有効である．</subsubsection>
  <subsubsection title="部分解析機能の導入">前項で述べた手法の狙いは，例外的な文法規則を見通しよく記述することであった．しかし，実際の文，特に口語表現のバリエーションは極めて多彩であり，文法記述を続けることのみによって十分なカバー率を得ることは困難である．例えば，文(16)のように，接続助詞「テ」の直後に終助詞「サ」が後続する文は自然な文ではあるが，現状のところ文法規則の中で対応する記述は行えていない．このような問題を解決するために，部分解析を実施する文法記述を行った．すなわち，前項までに述べた解析を全て実施してもなお解析結果が得られない場合のために，正規の文法表現とは異なる別の規則体系を用意し，部分的な解析結果のリストを得る．部分解析用の文法規則の例を以下に示す．ただし，OTマークとして定義された「OTmark1」「OTmark2」「OTmark3」はこの順に優先順位が高いものとする．この規則によって，文S，関係節Srel，後置詞句PP，名詞句NP，述部V，助詞Pのいずれかの構造が認められればそれが「FRAGMENTS」となり，c-structureにはFRAFMENTSのリスト構造が生成される．ただし，OTマークの付与によって，SやSrelの構造が認められれば，他の構造に優先してFRAGMENTSとなる．同様にf-structureとして，「FIRST」「REST」から成る部分解析結果のリスト構造が得られることになる．上記規則に基づいて得られた，文(16)の部分解析結果(c-structure)を図に示す．文末の「さ」の部分がFRAGMENTSとして切り離されてはいるものの，「さ」の直前の部分までは完全な解析結果が得られている．日本語では，非文法的・口語的な表現は述部，したがって文末(埋め込み文末)に見られる場合が多く，文の大部分は正常に解析できる傾向にある．すなわち，部分解析結果であっても，前項までに述べた正規の文法記述によって得られる解析結果とほぼ同等の解析結果(f-structure)を得ることができる場合が多い．</subsubsection>
  <section title="システムの評価"/>
  <subsection title="評価実験">まず，前章までに述べた日本語LFG文法記述に基づく解析システムのカバー率を測定するために，以下の3種類のテキストを対象に解析実験を行った．日本語文法の教科書中の例文(引用文)460文コピー機マニュアル文460文お客様相談センター(VoiceofCustomer)文10,000文(A)の460文と(B)の460文は文法に則った文が多い．一方(C)は，富士ゼロックスのお客様相談センターへの電話による問い合わせ内容を比較的忠実に人手でテキスト化したものである．したがって，口語的・非文法的な文が多く含まれている．(A)(B)(C)に含まれる文の例を表2に示す．解析実験の結果得られたカバー率を表3に示す．カバー率は，c-structureだけの出力ではなく，f-structureを伴う解析結果が得られた場合を対象としたものである．(A)の解析で使用した日本語LFG文法は，(A)の460文を予め見た上で記述を行ったものである．(B)のテキストは一見して括弧(「,」)の使用法に特徴があることが分かった．そこで，(B)の解析には，括弧の使用法に関する文法規則を(A)の解析で使用した文法に追加したものを用いた．(C)の解析に用いた日本語LFG文法は，(A)の解析で使用した文法と完全に同じものである．表から，部分解析結果を含めた場合のカバー率は(B)と(C)で同程度であるのに対して，含めない解析結果(正規の文法によって得られた解析結果)のカバー率は(C)が(B)を大きく下回っていることが分かる．既に述べたように(C)が口語的・非文法的な文を多く含むため，正規の文法で解析できる割合が小さくなったと考えることができる．次に，解析精度を測定するための準備としてf-structureを木構造へ変換した．つまり，f-structure中のPREDの値をノードとし，リンクには文法機能をラベルとして付与することでf-structureから木構造を生成する処理を行った．本実験では，f-structure中のPRED間の依存関係およびPRED間の文法機能に関する解析精度のみを測定し，他の属性・属性値は無視することにした．例として，文(17)のf-structureから得られる木構造を図に示す．実際には，f-structureはネットワーク構造である．したがって，異なる親ノードが同一の子ノードを持つ場合がある．このような場合には子ノードを複製し，木構造に変換する処理を行った．図中の「イラン」に対応するノードが，複製された例である．また，2章で述べた通り実際のf-structureではOBLのPREDに格助詞が挿入されているが，木構造のノードには自立語を対応させるといった若干の変換処理を行っている．解析精度の測定は，(B)コピー機マニュアル文460文の中で正規の文法によって解析結果が得られた文の中から100文をランダムに抽出して実験を行った．なお，この100文は，実験に用いた文法を記述する際に参考にしていない．100文に対して人手で正解の木構造を作成し，同じ100文に対して日本語LFGシステムから得られた解析結果(f-structureから得られた木構造)と比較した．比較は，木構造中の親ノード(PREDの値)と子ノード(PREDの値)のペアおよびそれらの間のリンクに付与されたラベル(文法機能)の3つ組に注目し，それらの再現率と適合率を計算した．5.1節で述べた通り，我々の日本語LFG文法では，文単位で文法的に正しいと認められる解析結果を全て出力する記述方針をとっている．これに対して本実験では文単位では本質的に曖昧性が解消できない場合であっても，文脈等から必ず1つの正解木を作成した．例えば，文(18)のように，「(太郎は面白いと)(誰かが)(言った)」と「(太郎は)(何かが面白いと)(言った)」という2つの解釈が成り立つ場合であっても，どちらかを正解とする．したがって，意図した通り2つの解析結果が得られたとしても，(一方は誤解析であると判定されるため)実験結果として100,%の解析精度が得られるとは限らないことに注意されたい．5mm得られた実験結果を表に示す．表中の平均値とは，「1つの文に対して得られる複数のf-structureに対応する各木構造を正解木と比較することにより再現率・適合率を算出して平均をとり，さらに100文の平均をとった値」である．上限値とは，「1つの文に対して得られる複数のf-structureに対応する各木構造の中から再現率あるいは適合率の最も高いものを選択し，100文の平均をとった値」である．上限値は，解析結果の曖昧性が理想的に解消された場合に得ることができる値である．下限値は，同様に「再現率あるいは適合率の最も低いものを選択し，100文の平均をとった値」である．また，PRED-GF-PREDは上記の3つ組のマッチングにより計算した値であり，PRED-PREDは，文法機能のラベルが異なっていても正解とみなして計算した値である．比較対象として，同じ100文をKNPとCabochaを用いて構文解析した場合の結果を表に示した．この値は，文節をノードとする依存木を比較対象とするもので，基本的にPRED-PREDに対応するものである．ただし，正解木中のノードは形態素(PREDの値)が単位であるため，ノード間のマッチングは，KNPあるいはCabochaから得られる依存木の各ノード(文節)中に正解木のノード(形態素)が一つでも含まれていればマッチするものとした．BASELINEは，正解木中の各ノードが文の並びの中で全て右隣に係るとした場合のPRED-PRED値である．</subsection>
  <subsection title="考察">本節では，前節の解析精度の結果をうけての考察を行う．まず，前節の実験で用いた正解木の特徴について述べる．実験で用いた正解木は，一般に構文解析の評価で用いられている文節間の係り受け関係のみを対象とするものとは異なり，文法機能(格構造)の評価を同時に行うものである．自然言語による対話・質問応答やe-mailに対する自動応答などのアプリケーションにおいて格構造を決定するタスクは重要な役割を果たすため，係り受け関係同様，格構造は重要な評価項目であるといえる．また，実検で用いた正解木は，前節で述べた通り，一部のノードが複製されているという特徴を持つ．文(17)(図)に示した使役文の場合や下記の文(19)のような関係節を含む文の場合に典型的にノードの複製が生じる．例えば，質問応答のアプリケーションを想定した場合，文(19)において「川端が(SUBJ)ノーベル文学賞を(OBJ)とった」と「川端が(SUBJ)雪国を(OBJ)書いた」という2つの格構造は質問に対する回答を生成する上で同等に重要な情報であると考えられる．同様に，文(18)において,「イラクが(SUBJ)イランを(OBJ)攻撃した」と「アメリカが(SUBJ)イラクに(OBL)イランを攻撃する(XCOMP)(ことを)させた」という2つの格構造は同等に重要な情報であると考えられる．文(18)中の「イラク」や文(19)中の「川端」を複製して正解木に含める理由は，複数の格構造をそれぞれ完全な形で明示することがこのような言語処理アプリケーションにとって有益であると考えられるからである．さらに，正解木のノードにはゼロ代名詞が含まれる．ゼロ代名詞の出現位置，すなわち，省略されている必須構成要素の位置を同定することは，照応解析・文脈解析にとって不可欠の処理であるためである．表中のBASELINEの値は，等で報告されているBASELINE値よりも低くなっている．これは，正解木のノードが文節単位ではなく形態素単位であるからである．例えば，「できません」を一つの単位とするのではなく，「できる」と「ぬ」の2つのノードが正解木中に存在することになる．(文節中の「ます」は5.1節で述べた通りPREDとはならず，したがって，ノードとして出現しないものとして正解木を作成した．)この際，LFGでは「ぬ」を「できる」の修飾成分(ADJUNCT,ADJUNCT-TYPE=neg)とする．したがって，この場合「ぬ」は左の位置にある「できる」を修飾することになる．同様に「トナーなど」の場合でも，「など」が「トナー」を修飾する接尾辞(ADJUNCT,ADJUNCT-TYPE=suffix)として左方向への係り受け関係を持つ．BASELINEは単純に右隣に掛ける方式のため，適合率・再現率共に，通常の文節単位の計測結果よりも低い値になる．さらに，文節単位の場合では分割しない「絶縁赤色ワイヤー」のような複合名詞の場合でも，「絶縁」と「赤色」が共に「ワイヤー」に係る解析を正解とするため，右隣に掛けるBASELINEの適合率・再現率を低くする要因となる．一方，KNPおよびCabochaの結果は，適合率と再現率に大きな差がある．これは，文節単位の係り受け関係のみが測定対象であるためである．適合率は，純粋に文節間の係り受け精度が測定されるのに対して，再現率は，上記に述べた複製ノードや，文節内の関係，およびゼロ代名詞に対応するノードを含む関係に全くマッチしないため低い値となる．再現率の値が異なるため，本システムとKNPあるいはCabochaの適合率を直接比較することはできないが，解析結果の内容を人手で比較した結果，文節間の係り受け関係の精度について顕著な差は認められなかった．5.1節で述べたように，本システムは複数の解析結果を出力する仕様となっている．表に示した上限値に対応する解析結果の場合，KNPおよびCabochaが出力する正しい係り受け関係(PRED-PRED)をほぼ全て含むものとなっていた．以下に，解析結果が異なっていた主要な例を挙げる．文(20)は，KNPで正しく解析され，本システムが誤った解析結果を出力した文である．日本語LFG文法では「一つの文節は同じ係り受け関係で二つ以上の文節を受けない」という係り受け関係の非重複性の制約を採用している．文(20)は，2つの埋め込み文が並置構造を成し，共にOBJとして「指定できます。」に係る構成となっている．現在の日本語LFG文法には，この並置構造を扱う文法規則(2つ以上の埋め込み文を1つのOBJに纏め上げる規則)が存在しなかったため，非重複性の制約に従い誤解析を出力する結果になった．今後，このような並置規則の精緻化を実施する必要がある．逆に，以下は既存の構文解析システムと比較して，本システムのような文法規則に基づいた深い解析を行うシステムが有利であると考えられる例である．KNPでは，文(21)中の「「コピー」の」の係り先が「参照してください。」となる．5.1節で述べた通り，「名詞+「ノ」」は関係節中あるいは埋め込み節中以外では連用修飾を行わない(SUBJとならない)．したがって，文法規則に基づく解析システムからはこのような誤った解析結果が出力されることはない．特に文(21)のケースは，関係節(Srel)という句構造に関する規則と主語(SUBJ)という文法機能に関する規則を，句構造規則(文脈自由文法規則)に機能的注釈を付与するかたちで関係付けて記述できるLFGのフォーマリズムが，文法を記述する上で有効に機能する例である．KNP，Cabocha共に，文頭の「名詞+「ハ」」を実際以上に文末の動詞句に掛ける傾向が強く，本システムが出力しない誤解析を出力するケースが見受けられた．例えば，両システム共に文(22)中の「コピーは」の係り先を「できます。」とする解析を行う．実際には，「コピーは」は係助詞「ハ」による格助詞「ガ」の省略であり，「コピー」は「出力される」のSUBJ(「出力する」のOBJ)である．本システムでも，係助詞や副助詞による格助詞の省略を正確に取り扱うための文法記述は十分であるとはいえないが，各述語の結合価とOTマークを利用した文法記述によって比較的良好な解析結果が得られている．今後さらに，等を参照することによって，「ハ」による主題化現象を扱う文法規則を句構造規則と機能的注釈の組み合わせで精緻化していくことができる点は，LFGに基づく解析システムの有利な点であるといえる．文法機能(格構造)の同定を含めた評価結果(PRED-GF-PRED)は，現在利用可能なシステムが公開されていないため他のシステムと比較しての考察はできない．しかし，今回の実験で，係り受け関係のみの精度と文法機能を含めた場合の精度の間に大きな乖離が見られないことを確認することができた．以上のように本システムは，係り受け関係については既存の構文解析システムと同程度の精度を有し，文法記述の継続によりさらなる精度の向上が期待できる．また，既存の構文解析システムと比較して，ゼロ代名詞，使役，関係節，副助詞，否定表現等をより詳細に解析できる特徴を持ち，今回の評価の対象外とした時制，様相，話法等の意味情報を出力することが可能である．これらは，対話や質問応答といったアプリケーションにとって有用な特徴であると共に，否定や副助詞のスコープの同定，ゼロ代名詞の実体特定等の解析処理に繋がるものである．</subsection>
  <section title="今後の課題">本稿で述べた日本語LFG文法は完成したものではなく，文法記述のさらなる精緻化が最も重要な課題である．5.3.1項で述べたOTマークのグループ化の手法を利用することにより，未対応の言語現象や，口語的・非文法的言語現象であっても頻出するものについては規則化を進めていく．これによって，カバー率を高めると共にカバー率全体に対する部分解析結果の占める割合を減じ，解析精度をさらに向上させることが可能であると期待できる．5.1節および前章で述べた通り，本稿で説明した日本語LFG文法は，文単位で文法的に正しいと認められる解析結果を全て出力する方針で記述している．もちろん，文法的に正しい解析結果と認められないf-structureに関しては，それらを減じるよう文法の精緻化と適切なOTマークの設定を継続的に行っている．これにより，表3で示した解析結果数にまでは曖昧性を抑えることが可能となっている．しかしながら，日本語LFG解析システムをアプリケーションに適用することを考えた場合，後工程として，曖昧性を完全に解消するためのシステムが必須である．統計的手法によって生成された格フレーム辞書を利用する等の方法で曖昧性解消を実現することが今後の課題である．3章および5章で述べた多言語間でf-structureの整合性を高める活動を継続することによって，等しいアーキテクチャで複数の言語を扱うことが可能な言語処理アプリケーションの構築が可能になると期待できる．しかしながら，異なる言語のf-structureの整合性の度合いを定量的に測定するための方法論は，これまでのところ提案されていない．このような評価手法の確立は今後の課題である．</section>
  <section title="おわりに">以上のように本稿では，他言語と高い整合性を持つf-structureを出力し，言語学的に精緻であり，かつ，高い解析カバー率を持つ日本語LFG文法およびシステムについて述べた．我々は，日本語に特徴的な言語現象を，過去の言語学的知見を活かして，LFG理論が持つ豊富な記述力の下に規則化するという作業を継続して行っている．自然言語の文法記述を完全に体系的・手続き的に進めることは困難であり，我々の文法記述においても経験的なものに依存する面は大きい．しかしながら，OTマークを利用して段階的に解析を行う手法によって，例外的な文法・語彙規則が解析結果に及ぼす悪影響を減じ，文法の大規模化に伴う記述の見通しの悪さを軽減することが可能となった．さらに，部分解析機能の導入によって，口語的・非文法的文への対処が可能となった．また，解析実験を行い，マニュアル文のような文法に則った文と，お客様相談センター文のような口語的な文の両者に対して，日本語LFGに基づくシステムとしてはこれまでにない，95,%以上の解析カバー率が得られていることを確認した．また，小規模な実験ではあるが，マニュアル文を対象に解析精度測定のための実験を行い，係り受けの再現率・適合率共に平均値で約84,%，上限値で約92,%の値が得られていることが確認できた．また，文法機能の同定を含めた評価でも再現率・適合率共に平均値で約78,%，上限値で約89,%の値が得られ，係り受けの精度と大きな乖離がないことが分かった．</section>
</root>
